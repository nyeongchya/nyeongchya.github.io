<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>NeoRivere 2098 - Broker Nexus</title>
  <link href="https://fonts.googleapis.com/css2?family=Gowun+Dodum&display=swap" rel="stylesheet">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

  <style>
.gowun-dodum-regular {
  font-family: "Gowun Dodum", sans-serif;
  font-weight: 400;
  font-style: normal;
}

:root{
  --bg-0: #050509;
  --bg-1: #0b0b0f;
  --panel: rgba(18,18,20,0.7);
  --neon-cyan: #00f0ff;
  --neon-pink: #ff34b3;
  --neon-emerald: #3cffb5;
  --text: #e6eef6;
  --muted: #9aa3ad;
  --neon-blue: #00f0ff;
  /* Glitch controls */
  --glitch-x: 2px;        
  --glitch-y: -1px;       
  --glitch-speed: 1600ms; 
  --scanline-opacity: 0.06;
  --transition-fast: 160ms;
}

*{box-sizing:border-box}
html,body{min-height:100vh;}
body{
  margin:0;
  font-family: "Gowun Dodum", ui-monospace, SFMono-Regular, Menlo, Monaco, monospace;
  background:
    radial-gradient(circle at top, #171724 0%, #050509 55%) fixed,
    linear-gradient(180deg, var(--bg-0) 0%, var(--bg-1) 100%);
  color:var(--text);
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
  overflow-y:scroll;
  cursor: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"><g fill="none" stroke="%23ffffff" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2v8M2 12h8M22 12h-8M12 22v-8"/></g></svg>') 12 12, crosshair;
}

/* basic layout */
.wrap{max-width:1100px;margin:28px auto;padding:24px;position:relative;z-index:2}
header{display:flex;align-items:center;justify-content:space-between;gap:18px}
.brand{display:flex;align-items:center;gap:14px}
.logo{width:56px;height:56px;border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:26px;background:linear-gradient(135deg,var(--neon-pink),#7b5cff);box-shadow:0 6px 25px rgba(0,0,0,0.6)}
.title{line-height:1}
.title h1{margin:0;font-family: 'Gowun Dodum', sans-serif;font-size:20px;letter-spacing:1px}
.title p{margin:0;font-size:12px;color:var(--muted)}

nav{display:flex;gap:8px;align-items:center}
.nav-btn{background:transparent;border:1px solid rgba(255,255,255,0.03);padding:8px 12px;border-radius:10px;font-size:13px;color:var(--text);transition:all var(--transition-fast);display:inline-flex;gap:8px;align-items:center}
.nav-btn:hover{transform:translateY(-3px);box-shadow:0 6px 18px rgba(0,0,0,0.7)}

/* panels */
.grid{display:grid;grid-template-columns:repeat(3,1fr);gap:14px;margin-top:18px}
.panel{background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); border:1px solid rgba(255,255,255,0.04); padding:14px;border-radius:12px;backdrop-filter:blur(4px)}

.big{grid-column:span 3}
.two{grid-column:span 2}

h2{margin:0 0 8px 0;font-family:'Gowun Dodum';letter-spacing:0.6px}
p.small{margin:0;color:var(--muted);font-size:13px}

/* summary boxes */
.stats{display:flex;gap:12px;margin-top:12px}
.stat{background:rgba(0,0,0,0.25);padding:12px;border-radius:10px;flex:1;text-align:center}
.stat .num{font-size:22px;font-weight:700;color:var(--neon-emerald)}

/* list */
.list{display:flex;flex-direction:column;gap:10px}
.job{padding:10px;border-radius:10px;background:rgba(0,0,0,0.25);border:1px solid rgba(255,255,255,0.02);transition:transform 180ms}
.job:hover{transform:translateY(-6px)}
.job .meta{font-size:12px;color:var(--muted)}

/* map */
.map-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:10px;margin-top:12px}
.zone{padding:10px;border-radius:10px;background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(0,0,0,0.2));border:1px solid rgba(255,255,255,0.03);cursor:help;position:relative;transition:transform 160ms}
.zone:hover{transform:translateY(-6px)}
.zone .key{font-size:12px;color:var(--muted);margin-top:8px}
.zone .tag{
  display:inline-block;
  margin-top:8px;
  font-size:11px;
  padding:4px 8px;
  border-radius:999px;
  background:rgba(0,0,0,0.55);
  border:1px solid rgba(0,255,255,0.4);
  color:var(--neon-emerald);
}

/* market (ê¸°ë³¸ ê·¸ë¦¬ë“œ, ì§€ê¸ˆì€ content-box ê¸°ë°˜ì´ë¼ í¬ê²Œ ì‚¬ìš© X) */
.market{display:grid;grid-template-columns:repeat(2,1fr);gap:10px;margin-top:12px}
.item{display:flex;justify-content:space-between;align-items:center;padding:10px;border-radius:10px;background:rgba(0,0,0,0.2)}
.item .meta{font-size:12px;color:var(--muted)}

/* controls */
.controls{display:flex;gap:8px;align-items:center}
.btn{background:linear-gradient(90deg,var(--neon-pink),var(--neon-cyan));border:none;padding:8px 12px;border-radius:10px;color:#000;font-weight:700;cursor:pointer}
.btn.secondary{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--text);font-weight:600}
.micro{font-size:12px;padding:6px 8px;border-radius:8px}

/* footer */
footer{margin-top:18px;text-align:center;color:var(--muted);font-size:12px;padding:18px}

/* Glitch CSS (layers) */
.glitch {
  position: relative;
  display: inline-block;
  color: var(--text);
  --g1: var(--glitch-x);
  --g2: calc(var(--glitch-x) * -1);
  --gy: var(--glitch-y);
}
.glitch::before,
.glitch::after{
  content: attr(data-text);
  position: absolute;
  left:0;top:0;
  width:100%;
  height:100%;
  overflow:visible;
  clip-path: inset(0 0 0 0);
  pointer-events:none;
}
.glitch::before{
  color: var(--neon-pink);
  transform:translate(var(--g1), var(--gy));
  mix-blend-mode:screen;
  opacity:0.9;
  animation:glitch-anim var(--glitch-speed) linear infinite;
}
.glitch::after{
  color: var(--neon-cyan);
  transform:translate(var(--g2), calc(var(--gy) * -1));
  mix-blend-mode:screen;
  opacity:0.85;
  animation:glitch-anim-2 calc(var(--glitch-speed) * 0.7) linear infinite;
}

@keyframes glitch-anim {
  0%{transform:translate(var(--g1), var(--gy))}
  10%{transform:translate(calc(var(--g1) * 1.3), var(--gy))}
  20%{transform:translate(calc(var(--g1) * -0.6), calc(var(--gy) * 1.2))}
  30%{transform:translate(var(--g1), calc(var(--gy) * -1))}
  40%{transform:translate(0,0)}
  100%{transform:translate(var(--g1), var(--gy))}
}
@keyframes glitch-anim-2 {
  0%{transform:translate(var(--g2), calc(var(--gy) * -1))}
  15%{transform:translate(calc(var(--g2) * -1.5), calc(var(--gy) * -1.2))}
  35%{transform:translate(var(--g2), 0)}
  60%{transform:translate(calc(var(--g2) * 0.8), var(--gy))}
  100%{transform:translate(var(--g2), calc(var(--gy) * -1))}
}

/* scanlines */
.scanlines:before{
  content:"";
  position:fixed;left:0;right:0;top:0;bottom:0;pointer-events:none;
  background-image:linear-gradient(rgba(255,255,255,var(--scanline-opacity)) 1px, transparent 1px);
  background-size:100% 4px;
  mix-blend-mode:overlay;
  z-index:1;
}

/* noise overlay (using SVG data inline for portability) */
.noise{
  position:fixed;left:0;top:0;right:0;bottom:0;pointer-events:none;opacity:0.08;
  background-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="512" height="512" viewBox="0 0 512 512"><filter id="n"><feTurbulence baseFrequency="0.9" numOctaves="2" stitchTiles="stitch"/><feColorMatrix type="saturate" values="0"/></filter><rect width="512" height="512" filter="url(%23n)" opacity="0.85"/></svg>');
  mix-blend-mode:overlay;z-index:0;
}

/* tooltip */
.tooltip{position:absolute;background:linear-gradient(180deg,rgba(0,0,0,0.9),rgba(10,10,10,0.9));padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);font-size:13px;transform:translateY(-8px);white-space:nowrap;z-index:20;pointer-events:none}

/* easter eggs */
.egg{position:fixed;bottom:16px;right:16px;opacity:0.28;transition:opacity 200ms}
.egg:hover{opacity:1}

/* subtle animations */
.fade-in{animation:fadeIn 600ms ease both}
@keyframes fadeIn{from{opacity:0;transform:translateY(6px)}to{opacity:1;transform:none}}

/* responsive */
@media (max-width:900px){
  .grid{grid-template-columns:repeat(1,1fr)}
  .map-grid{grid-template-columns:repeat(2,1fr)}
}

/* Force cyberpunk cursor globally */
*, *:hover, button, button:hover, .btn, .btn:hover, .nav-btn, .nav-btn:hover {
  cursor: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"><g fill="none" stroke="%23ffffff" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2v8M2 12h8M22 12h-8M12 22v-8"/></g></svg>') 12 12, crosshair !important;
}

/* PANEL glow boost */
.panel {
  box-shadow: 0 0 22px rgba(0, 255, 255, 0.06), inset 0 0 12px rgba(255, 0, 180, 0.05);
  transition: transform 200ms, box-shadow 200ms;
}
.panel:hover {
  transform: translateY(-4px);
  box-shadow: 0 0 28px rgba(0, 255, 255, 0.1), inset 0 0 16px rgba(255, 0, 180, 0.08);
}

/* buttons neon pulse */
.btn, .nav-btn {
  position: relative;
  overflow: hidden;
}
.btn::before, .nav-btn::before {
  content:'';
  position:absolute;
  inset:0;
  background:linear-gradient(90deg, rgba(255,0,180,0.3), rgba(0,255,255,0.3));
  mix-blend-mode:overlay;
  opacity:0;
  transition:opacity 180ms;
}
.btn:hover::before, .nav-btn:hover::before {
  opacity:0.35;
}

/* job & map zone hover neon */
.job:hover {
  box-shadow: 0 0 20px rgba(255,0,180,0.15);
}
.zone:hover {
  box-shadow: 0 0 26px rgba(0,255,255,0.18);
}

/* CRT distortion effect */
body {
  filter: contrast(1.02) brightness(1.05) saturate(1.1);
}

/* Random light flicker */
@keyframes flicker {
  0% { opacity: 1; }
  50% { opacity: 0.94; }
  100% { opacity: 1; }
}
.scanlines:before {
  animation: flicker 3s infinite;
}

.sideColumn {
  position: fixed;
  top: 0;
  bottom: 0;
  width: 150px;
  padding: 20px;
  font-size: 11px;
  color: var(--muted);
  line-height: 1.4;
  pointer-events: none;
  opacity: 0.45;
  mix-blend-mode: screen;
  text-shadow: 0 0 6px var(--neon-pink);
  margin-left: 50px;
  margin-right: 50px;
}

#sideNoiseLeft { left: 0; }
#sideNoiseRight { right: 0; }

.sideColumn::before {
  content:
  "ã€ë„¤ì˜¤ë¦¬ë² ë¥´ ê´‘ì—­ ê°ì‹œë§ ì•ˆë‚´ã€‘\A\A"
  "â–¶ NSC: ë„ì‹œ ìƒì¸µ í†µí•© ê°ì‹œ ìœ„ì›íšŒ â€” ê³µì‹ ê¸°ë¡ì—ëŠ” ì¡´ì¬í•˜ì§€ ì•ŠëŠ”ë‹¤ê³  ëª…ì‹œë¨\A"
  "â–¶ NMC: ë„¤ì˜¤ë¦¬ë² ë¥´ ìœ ì§€Â·ê´€ë¦¬ë‹¨ â€” ì•¼ê°„ ì •ë¹„ ì¤‘ ë¹„ì¸ê°€ êµ¬ì¡°ë¬¼ ì€í ë³´ê³  ë‹¤ìˆ˜\A\A"
  "â–¶ í˜„ìƒìˆ˜ë°° ëŒ€ìƒ: ì…€ë ˆë¥´ë‹ˆì•„ (ìœ„í—˜ë“±ê¸‰: BLACK)\A"
  "   - ë„¤íŠ¸ì›Œí¬ ì¹¨íˆ¬ 14íšŒ ê¸°ë¡\A"
  "   - ë¶ˆë²• AI ë¡œë”© 3ê±´\A"
  "   - ì „ì ê°ì‹œ ìš°íšŒ 27íšŒ ì ë°œ\A\A"
  "â–¶ ê´‘ê³ : 'ë„¤ì˜¨ ë¸”ëŸ¬ë“œ ì•½êµ­'ì—ì„œ ì‚¬ì´ë²„ ë³´ì¡°ì œ 40% í• ì¸\A"
  "â–¶ ê´‘ê³ : ë¶ˆë²• ì‚¬ì´ë²„ì›¨ì–´ ì¥ì°© ì‹œ ê¸°ìˆ ì ë°°ì • ê°€ëŠ¥\A\A"
  "â–¶ ì‹œìŠ¤í…œ ê²½ê³ : íŒ¨í‚· ì†ì‹¤ë¥  72%\A"
  "â–¶ ì˜¤ë¥˜: NODE-33C ì—°ê²° ì‹¤íŒ¨ â–ˆâ–ˆâ–ˆ\A"
  "â–¶ ë¡œê·¸ ëˆ„ë½ ê°ì§€: TIME_STAMP_CORRUPTED%%%\A"
  "â–¶ NSC ë‚´ë¶€ ì±„ë„ ë…¸ì´ì¦ˆ: \"â€¦NMC ì•¼ê°„ ë£¨íŠ¸ë¥¼ ë‹¤ì‹œ í™•ì¸í•´ ë´â€¦\"\A"
  "â–¶ ë©”ì‹œì§€ ì¬êµ¬ì„± ì¤‘ â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’\A"
  "â–¶ ì•”í‘ì „íŒŒ ìˆ˜ì‹ : 'â€¦ê±°ê¸° ëˆ„êµ¬ëƒâ€¦?'\A\A"
  "â–¶ TIP: ê°ì‹œ ë“œë¡ ì€ 4ì´ˆ ê°„ê²©ìœ¼ë¡œ ê¶¤ë„ë¥¼ ë³€ê²½í•¨\A"
  "â–¶ TIP: íêµ¬ì—­ D-4ëŠ” ìµœê·¼ ë¯¼ê°„ì¸ ì ‘ê·¼ ì°¨ë‹¨ë¨\A\A"
  "â–¶ ì˜¤ë¥˜ ë¤í”„ ì‹œì‘\A"
  "   > META-DATA BREAK\A"
  "   > SIGNAL ECHO Ã—Ã—Ã—\A"
  "   > TEXT_FRAGMENT: 'ë„ë§ì³â€¦'\A"
  "   > DATA CONTAMINATED ########\A";
  white-space: pre-wrap;
}

@keyframes driftGlitch {
  0% { transform: translate(0,0); filter: hue-rotate(0deg); }
  30% { transform: translate(-1px, 0); filter: hue-rotate(15deg); }
  60% { transform: translate(1px, -1px); filter: hue-rotate(-10deg); }
 100% { transform: translate(0,0); filter: hue-rotate(0deg); }
}

.glitch-text {
  animation: driftGlitch 2.5s infinite ease-in-out;
}

body::after {
  content:"";
  position:fixed;
  inset:0;
  pointer-events:none;
  background:
    repeating-linear-gradient(to bottom,
      rgba(0,255,255,0.02) 0px,
      rgba(255,0,180,0.03) 2px,
      transparent 3px,
      transparent 4px
    );
  mix-blend-mode: overlay;
  opacity:0.25;
}

@keyframes sparkFade {
  from { transform: scale(1); opacity:1; }
  to   { transform: scale(2.3); opacity:0; }
}

body.scanlines {
  animation: screenShake 0.55s infinite linear;
}

/* Text Selection Glitch */
::selection {
  background: rgba(255, 0, 180, 0.35);
  color: #00f0ff;
  text-shadow:
    1px 0 var(--neon-pink),
    -1px -1px var(--neon-cyan),
    0 1px #000;
  mix-blend-mode: screen;
}

#Market .item-list {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(210px, 1fr));
  gap: 14px;
}


/* ê³µí†µ content-box UI (ë‹¤ë¥¸ ì„¹ì…˜ ì¹´ë“œì™€ ê±°ì˜ ë™ì¼) */
.content-box {
  border: 1px solid #00ffff55; 
  padding: 12px;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(3px);
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.content-box:hover {
  transform: translateY(-2px);
  box-shadow: 0 0 12px #00ffff44;
}

.box-header {
  display: flex;
  justify-content: space-between;
  font-weight: 600;
  color: #00ffffcc;
}

.low-stock {
  color: #ff0055;
  font-weight: bold;
}

/* ğŸ¯ Market ì„¹ì…˜ ì¹´ë“œ â€” íŒ¨ë„ ìŠ¤íƒ€ì¼ í†µì¼ */
#Market .content-box {
  border: 1px solid rgba(255, 255, 255, 0.05);
  background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
  backdrop-filter: blur(4px);
  padding: 14px;
  border-radius: 12px;
  box-shadow: 0 0 22px rgba(0, 255, 255, 0.06), inset 0 0 12px rgba(255, 0, 180, 0.05);
  transition: transform 200ms, box-shadow 200ms;
  font-family: "Gowun Dodum", sans-serif !important;
}

#Market .content-box:hover {
  transform: translateY(-4px);
  box-shadow: 0 0 28px rgba(0, 255, 255, 0.1), inset 0 0 16px rgba(255, 0, 180, 0.08);
}

#Market .item-name {
  font-weight: 600;
  font-size: 16px;
  margin: 0;
  color: var(--text);
}

#Market .item-id {
  font-size: 12px;
  color: var(--muted);
}

#Market .item-desc {
  font-size: 13px;
  line-height: 1.45;
  color: var(--muted);
}

#Market .box-footer {
  display: flex;
  justify-content: space-between;
  font-size: 13px;
  color: var(--muted);
}

#Market .low-stock {
  color: var(--neon-pink);
  font-weight: 700;
}

#Market .buy-btn {
  background: transparent;
  border: 1px solid rgba(255,255,255,0.06);
  color: var(--text);
  padding: 8px;
  border-radius: 10px;
  cursor: pointer;
  transition: all 160ms;
}

#Market .buy-btn:hover {
  background: linear-gradient(90deg,var(--neon-pink),var(--neon-cyan));
  color: #000;
}
/* =========================
   ì–¸ë”ë„· ë¡œë”© í™”ë©´
   ========================= */
   #loading-screen {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100vh;  /* í™”ë©´ ë†’ì´ ë”± ë§ê²Œ */
  background:
    radial-gradient(circle at top, #19001f 0%, #03030a 55%);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 9999;
  color: var(--text);
  font-family: "Gowun Dodum", sans-serif;
  transition: opacity 0.4s ease;
}


#loading-screen .loading-inner {
  max-width: 420px;
  padding: 24px 32px;
  border-radius: 16px;
  background: rgba(0,0,0,0.9);
  border: 1px solid rgba(255,0,180,0.6);
  box-shadow:
    0 0 36px rgba(255,0,180,0.4),
    0 0 22px rgba(0,255,255,0.35);
  text-align: center;
}

#loading-screen .loading-title {
  font-size: 18px;
  margin-bottom: 8px;
}

#loading-screen .loading-sub {
  font-size: 13px;
  color: var(--muted);
  margin-bottom: 16px;
}

#loading-screen .loading-bar {
  position: relative;
  height: 4px;
  border-radius: 999px;
  overflow: hidden;
  background: rgba(255,255,255,0.08);
  margin-bottom: 10px;
}

#loading-screen .loading-bar-fill {
  position: absolute;
  left: -40%;
  top: 0;
  bottom: 0;
  width: 40%;
  background: linear-gradient(90deg, var(--neon-pink), var(--neon-cyan));
  animation: loadingSlide 1.2s infinite;
}

#loading-screen .loading-hint {
  font-size: 11px;
  color: var(--muted);
}

@keyframes loadingSlide {
  0%   { transform: translateX(0); }
  100% { transform: translateX(260%); }
}

/* ê³µí†µ UI íŒì—… (ì•Œë¦¼ìš©) */
#uiPopup{
  position: fixed;
  inset: 0;
  display: none;              /* JSì—ì„œ flexë¡œ ë°”ê¿ˆ */
  align-items: center;
  justify-content: center;
  background: rgba(0,0,0,0.68);
  z-index: 999;
}

#uiPopup .popup-content{
  background: rgba(5,5,12,0.96);
  border-radius: 14px;
  border: 1px solid var(--neon-pink);
  padding: 18px 20px;
  max-width: 420px;
  width: 90%;
  box-shadow:
    0 0 26px rgba(255,0,160,0.6),
    0 0 14px rgba(0,255,255,0.4);
  font-size: 14px;
  line-height: 1.5;
}

/* Jobs ìƒíƒœ í•„í„° ë²„íŠ¼ í™œì„±í™” */
.job-filter.active {
  border-color: var(--neon-cyan);
  box-shadow: 0 0 12px rgba(0,255,255,0.35);
}

.world-ticker {
  margin-top: 8px;
  font-size: 11px;
  color: var(--muted);
  display: flex;
  gap: 8px;
  align-items: center;
  letter-spacing: 0.06em;
  text-transform: uppercase;
  border-top: 1px solid rgba(255,255,255,0.06);
  padding-top: 6px;
}

.world-ticker .label {
  color: var(--neon-emerald);
  font-weight: 600;
}

/* =========================
   NeoRivere: Jobs / Intel / Map Worldbook UI
   ========================= */
   .nd-section-header{
  display:flex;
  justify-content:space-between;
  align-items:flex-end;
  gap:12px;
  margin-bottom:10px;
}
.nd-section-caption{
  font-size:12px;
  color:var(--muted);
  margin-top:4px;
}
.nd-section-actions{
  display:flex;
  gap:8px;
  align-items:center;
}

/* Featured Contracts (ë­í¬ ì˜ë¢° ì¹´ë“œ) */
.nd-contract-grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
  gap:10px;
  margin-top:10px;
  margin-bottom:14px;
}
.nd-contract-card{
  position:relative;
  padding:12px;
  border-radius:12px;
  background:rgba(0,0,0,0.45);
  border:1px solid rgba(255,255,255,0.08);
  font-size:13px;
}
.nd-contract-rank{
  font-size:11px;
  letter-spacing:0.08em;
  text-transform:uppercase;
  color:var(--muted);
  margin-bottom:4px;
}
.nd-contract-title{
  font-weight:600;
  margin-bottom:6px;
}
.nd-contract-body{
  color:var(--muted);
  line-height:1.45;
}
.nd-contract-meta{
  font-size:11px;
  color:var(--muted);
  margin-top:6px;
  display:flex;
  justify-content:space-between;
}
.nd-contract-pill{
  display:inline-flex;
  align-items:center;
  gap:4px;
  padding:2px 8px;
  border-radius:999px;
  font-size:11px;
  border:1px solid rgba(255,255,255,0.16);
  margin-top:4px;
}

.nd-rank-s{
  border-color:rgba(255,0,180,0.7);
  box-shadow:0 0 16px rgba(255,0,180,0.25);
}
.nd-rank-a{
  border-color:rgba(0,255,255,0.6);
}
.nd-rank-c{
  border-style:dashed;
  border-color:rgba(255,255,255,0.18);
}

/* Intel Feed */
.nd-intel-grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(260px,1fr));
  gap:10px;
  margin-top:10px;
}
.nd-intel-card{
  padding:12px;
  border-radius:12px;
  background:rgba(0,0,0,0.45);
  border:1px solid rgba(255,255,255,0.05);
  font-size:13px;
  position:relative;
}
.nd-intel-top{
  display:flex;
  justify-content:space-between;
  gap:8px;
  align-items:flex-start;
}
.nd-intel-title{
  font-weight:600;
}
.nd-intel-meta{
  font-size:11px;
  color:var(--muted);
  margin-top:3px;
}
.nd-intel-tag{
  font-size:10px;
  text-transform:uppercase;
  letter-spacing:0.08em;
  padding:2px 6px;
  border-radius:999px;
  border:1px solid rgba(0,255,255,0.4);
}
.nd-intel-body{
  margin-top:6px;
  color:var(--muted);
  line-height:1.45;
}

/* Intel êµ¬ì—­ í•˜ì´ë¼ì´íŠ¸ / ë””ë° */
.nd-intel-card.intel-highlight {
  border-color: rgba(0, 255, 255, 0.8);
  box-shadow: 0 0 20px rgba(0, 255, 255, 0.55);
  transform: translateY(-3px);
}

.nd-intel-card.intel-dim {
  opacity: 0.35;
  filter: grayscale(0.2);
}

/* Map Layout + Detail */
.nd-map-layout{
  display:grid;
  grid-template-columns:minmax(0,1.8fr) minmax(0,2.2fr);
  gap:14px;
  margin-top:10px;
}
.nd-map-detail{
  padding:12px;
  border-radius:12px;
  background:rgba(0,0,0,0.45);
  border:1px solid rgba(255,255,255,0.06);
  font-size:13px;
}
.nd-map-detail-title{
  font-weight:600;
  font-size:16px;
  margin-bottom:4px;
}
.nd-map-detail-level{
  font-size:12px;
  color:var(--muted);
  margin-bottom:8px;
}
.nd-map-detail-desc{
  color:var(--muted);
  line-height:1.45;
  margin-bottom:6px;
}
.nd-map-detail-key{
  font-size:12px;
  color:var(--neon-emerald);
}

@media (max-width:900px){
  .nd-map-layout{
    grid-template-columns:1fr;
  }
}

/* Hologram zone preview in left bottom */
.nd-map-holo{
  margin-top:10px;
  padding:10px;
  border-radius:10px;
  border:1px dashed rgba(0,255,255,0.45);
  background:radial-gradient(circle at top,
              rgba(0,255,255,0.12),
              rgba(0,0,0,0.9));
  box-shadow:0 0 18px rgba(0,255,255,0.18);
  font-size:11px;
  color:var(--muted);
  position:relative;
  overflow:hidden;
}

.nd-map-holo::before{
  content:"";
  position:absolute;
  left:-30%;
  right:-30%;
  top:-50%;
  height:200%;
  background:linear-gradient(
    to bottom,
    transparent,
    rgba(0,255,255,0.18),
    transparent
  );
  transform:rotate(8deg);
  animation:ndHoloSweep 3.5s infinite linear;
  pointer-events:none;
}

@keyframes ndHoloSweep{
  0%{ transform:translateY(40%) rotate(8deg); }
  100%{ transform:translateY(-40%) rotate(8deg); }
}

.nd-map-holo-label{
  font-size:10px;
  letter-spacing:0.12em;
  text-transform:uppercase;
  color:var(--neon-emerald);
  opacity:0.7;
}

.nd-map-holo-name{
  margin-top:4px;
  font-size:14px;
  font-weight:600;
  color:var(--neon-emerald);
}

.nd-map-holo-meta{
  margin-top:2px;
  font-size:11px;
  color:var(--muted);
}

.nd-map-holo-grid{
  margin-top:8px;
  display:grid;
  grid-template-columns:repeat(4,1fr);
  gap:3px;
}

.nd-map-holo-cell{
  height:8px;
  border-radius:2px;
  background:rgba(0,255,255,0.08);
}

.nd-map-holo-cell.active{
  background:linear-gradient(90deg,var(--neon-pink),var(--neon-cyan));
  box-shadow:0 0 8px rgba(0,255,255,0.6);
}

.nd-map-ops {
  margin-top: 10px;
  padding: 10px 12px;
  border-radius: 10px;
  background: rgba(0, 0, 0, 0.45);
  border: 1px dashed rgba(0, 255, 255, 0.25);
  font-size: 12px;
  color: var(--muted);
}

.nd-map-ops-title {
  font-size: 11px;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  color: var(--neon-emerald);
  margin-bottom: 6px;
}

.nd-map-ops-grid {
  display: grid;
  grid-template-columns: repeat(3, minmax(0, 1fr));
  gap: 8px;
}

.ops-item .label {
  font-size: 11px;
  color: var(--muted);
}

.ops-item .value {
  margin-top: 3px;
  font-size: 12px;
  color: var(--text);
}
@media (max-width: 900px) {
  .nd-map-ops-grid {
    grid-template-columns: 1fr;
  }
}

/* ==== ì„¹ì…˜ ì´ë™ ROUTING ì˜¤ë²„ë ˆì´ ==== */
#routeOverlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100vh;  /* í™”ë©´ ë†’ì´ ê¸°ì¤€ìœ¼ë¡œ ê½‰ ì±„ìš°ê¸° */
  display: flex;
  align-items: center;   /* ì„¸ë¡œ ì¤‘ì•™ */
  justify-content: center; /* ê°€ë¡œ ì¤‘ì•™ */
  pointer-events: none;
  opacity: 0;
  transition: opacity 0.35s ease;
  z-index: 998;
  background: radial-gradient(circle at center,
    rgba(0, 0, 0, 0.75) 0%,
    rgba(0, 0, 0, 0.96) 55%);
}


#routeOverlayInner {
  padding: 18px 26px;
  border-radius: 14px;
  border: 1px solid rgba(0,255,255,0.7);
  box-shadow:
    0 0 22px rgba(0,255,255,0.5),
    0 0 12px rgba(255,0,160,0.4);
  background: rgba(0,0,0,0.9);
  font-size: 13px;
  text-align: center;
}

#routeOverlayTitle {
  font-size: 12px;
  letter-spacing: 0.14em;
  text-transform: uppercase;
  color: var(--neon-emerald);
  margin-bottom: 6px;
}

#routeOverlayText {
  font-size: 16px;
  font-weight: 600;
}

#routeOverlay.visible {
  opacity: 1;
  pointer-events: auto;
}

/* ==== Jobs ì¹´ë“œ ìŠ¤ìº” ë¼ì¸ íš¨ê³¼ ==== */
.job {
  position: relative;
  overflow: hidden;
}

.job::before {
  content:"";
  position: absolute;
  left:-40%;
  right:-40%;
  top:-60%;
  height:120%;
  background: linear-gradient(
    to bottom,
    transparent,
    rgba(0,255,255,0.25),
    transparent
  );
  opacity:0;
  transform: translateY(80%);
  pointer-events:none;
}

.job:hover::before {
  opacity: 1;
  animation: jobScan 0.9s linear;
}

@keyframes jobScan {
  0%   { transform: translateY(80%); }
  100% { transform: translateY(-80%); }
}

/* ==== Map Holo íŒ¨ë„ ì„ íƒ í„ìŠ¤ ==== */
.nd-map-holo.pulse {
  animation: holoPulse 1.4s ease-out;
}

@keyframes holoPulse {
  0% {
    box-shadow:
      0 0 4px rgba(0,255,255,0.3),
      0 0 0 0 rgba(0,255,255,0.25);
  }
  70% {
    box-shadow:
      0 0 18px rgba(0,255,255,0.7),
      0 0 28px 12px rgba(0,255,255,0.0);
  }
  100% {
    box-shadow:
      0 0 8px rgba(0,255,255,0.4),
      0 0 0 0 rgba(0,255,255,0.0);
  }
}

/* =========================
   Side floating alert cards
   ========================= */
   .side-alert {
  position: fixed;
  width: 190px;
  max-width: 44vw;
  padding: 8px 10px;
  font-size: 11px;
  line-height: 1.4;
  color: var(--text);
  background: rgba(3, 3, 10, 0.96);
  border-radius: 10px;
  border: 1px solid rgba(255, 0, 180, 0.7);
  box-shadow:
    0 0 14px rgba(255, 0, 180, 0.5),
    0 0 8px rgba(0, 255, 255, 0.35);
  z-index: 3;
  pointer-events: none;
  opacity: 0;
  transform: translateY(6px) scale(0.98);
  animation: sideAlertInOut 4.2s ease-out forwards;
  backdrop-filter: blur(4px);
}

.side-alert-left {
  left: 24px;
  text-align: left;
}

.side-alert-right {
  right: 24px;
  text-align: right;
}

.side-alert-title {
  font-size: 10px;
  letter-spacing: 0.16em;
  text-transform: uppercase;
  color: var(--neon-emerald);
  margin-bottom: 3px;
}

.side-alert-body {
  font-size: 11px;
}

.side-alert-tag {
  margin-top: 5px;
  font-size: 10px;
  text-transform: uppercase;
  letter-spacing: 0.12em;
  color: var(--muted);
  opacity: 0.8;
}

/* ë“±ì¥í–ˆë‹¤ê°€ ì‚¬ë¼ì§€ëŠ” ì• ë‹ˆë©”ì´ì…˜ */
@keyframes sideAlertInOut {
  0% {
    opacity: 0;
    transform: translateY(12px) scale(0.95);
  }
  12% {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
  70% {
    opacity: 1;
    transform: translateY(-2px) scale(1.01);
  }
  100% {
    opacity: 0;
    transform: translateY(-6px) scale(0.97);
  }
}

.side-alert-left {
  left: 24px;
  text-align: left;
}

.side-alert-right {
  right: 24px;
  text-align: right;
}

.side-alert-title {
  font-size: 10px;
  letter-spacing: 0.16em;
  text-transform: uppercase;
  color: var(--neon-emerald);
  margin-bottom: 3px;
}

.side-alert-body {
  font-size: 11px;
}

.side-alert-tag {
  margin-top: 5px;
  font-size: 10px;
  text-transform: uppercase;
  letter-spacing: 0.12em;
  color: var(--muted);
  opacity: 0.8;
}

/* ë“±ì¥í–ˆë‹¤ê°€ ì‚¬ë¼ì§€ëŠ” ì• ë‹ˆë©”ì´ì…˜ */
@keyframes sideAlertInOut {
  0% {
    opacity: 0;
    transform: translateY(12px) scale(0.95);
  }
  12% {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
  70% {
    opacity: 1;
    transform: translateY(-2px) scale(1.01);
  }
  100% {
    opacity: 0;
    transform: translateY(-6px) scale(0.97);
  }
}

/* ===== Contact: ì…€ë ˆë¥´ë‹ˆì•„ í†µì‹  í—ˆë¸Œ ===== */
.contact-layout{
  margin-top:12px;
  display:flex;
  gap:14px;
  align-items:flex-start;
  flex-wrap:wrap;
}
.contact-composer{
  flex:1;
  min-width:240px;
}
.contact-log-panel{
  flex:1.3;
  min-width:260px;
  max-height:260px;
  padding:10px;
  border-radius:12px;
  background:rgba(0,0,0,0.45);
  border:1px solid rgba(255,255,255,0.06);
  overflow-y:auto;
}
.contact-log-title{
  font-size:14px;
  font-weight:600;
}
.contact-log-caption{
  font-size:11px;
  color:var(--muted);
}
.contact-log-list{
  margin-top:8px;
  display:flex;
  flex-direction:column;
  gap:8px;
  font-size:12px;
}
.contact-log-entry{
  padding:8px 10px;
  border-radius:8px;
  background:rgba(0,0,0,0.55);
  border:1px solid rgba(0,255,255,0.18);
}
.contact-log-meta{
  display:flex;
  justify-content:space-between;
  gap:8px;
  margin-bottom:4px;
  font-size:11px;
  color:var(--muted);
}
.contact-log-from{
  font-weight:600;
  color:var(--neon-emerald);
}
.contact-log-to{
  opacity:0.9;
}
.contact-log-kind{
  margin-left:4px;
  font-size:10px;
  letter-spacing:0.1em;
  text-transform:uppercase;
  color:var(--muted);
}
.contact-log-body{
  white-space:pre-line;
  color:var(--text);
}
.contact-log-empty{
  font-size:12px;
  color:var(--muted);
  opacity:0.9;
}

@media (max-width:900px){
  .contact-log-panel{
    max-height:220px;
  }
}
/* ===== ì‚¬ë¬´ì†Œ ì¸ë¬¼ ë¸Œë¦¬í•‘ ì¹´ë“œ ===== */
.staff-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
  gap: 10px;
  margin-top: 10px;
}

.staff-card {
  padding: 12px;
  border-radius: 12px;
  background: rgba(0,0,0,0.5);
  border: 1px solid rgba(255,255,255,0.06);
  box-shadow: 0 0 16px rgba(0,255,255,0.08);
  font-size: 13px;
}

.staff-header {
  display: flex;
  justify-content: space-between;
  align-items: baseline;
  gap: 6px;
}

.staff-name {
  font-weight: 600;
  font-size: 15px;
}

.staff-role {
  font-size: 11px;
  color: var(--muted);
}

.staff-tagline {
  margin-top: 4px;
  font-size: 12px;
  color: var(--neon-emerald);
}

.staff-body {
  margin-top: 6px;
  color: var(--muted);
  line-height: 1.45;
}

.staff-meta {
  margin-top: 8px;
  display: flex;
  justify-content: space-between;
  font-size: 11px;
  color: var(--muted);
}

.staff-pill {
  padding: 2px 8px;
  border-radius: 999px;
  border: 1px solid rgba(0,255,255,0.45);
  font-size: 10px;
  text-transform: uppercase;
  letter-spacing: 0.08em;
}


  </style>
</head>

<body class="scanlines">

    <!-- ğŸ”» ì–¸ë”ë„· ì ‘ì† ë¡œë”© í™”ë©´ -->
    <div id="loading-screen">
      <div class="loading-inner">
        <div class="loading-title glitch" data-text="ACCESSING UNDERNET NODE...">
          ACCESSING UNDERNET NODE...
        </div>
        <div class="loading-sub">
          ê¶Œí•œ ì—†ëŠ” ì ‘ì† ì‹œë„ ê°ì§€â€¦<br>
          ì•”ì‹œì¥ ë¼ìš°íŒ… í…Œì´ë¸” ì¬êµ¬ì„± ì¤‘â€¦
        </div>
        <div class="loading-bar">
          <div class="loading-bar-fill"></div>
        </div>
        <div class="loading-hint">
          ë„¤ì˜¤ë¦¬ë² ë¥´ì— ì˜¤ì‹ ê±¸ í™˜ì˜í•©ë‹ˆë‹¤.<br>
          STATUS: <span style="color:#ff3b7b;">GLITCHED</span>
        </div>
      </div>
    </div>
  

  <div class="noise"></div>

  <div class="wrap fade-in" id="app">
    <header>
      <div class="brand">
        <div class="logo">ğŸ•¶ï¸</div>
        <div class="title">
          <h1><span class="glitch" data-text="NeoRivere 2098">NeoRivere 2098</span></h1>
          <p class="small">ì€ë°€í•œ ì˜ë¢° Â· ìµëª… ì—°ê²° Â· ì‹¤ì‹œê°„ ì¸í…”</p>
        </div>
      </div>

      <nav>
        <button class="nav-btn" data-target="home">Home</button>
        <button class="nav-btn" data-target="jobs">Jobs <span style="font-size:10px;margin-left:1px;color:var(--muted)">(<span id="jobs-count">0</span>)</span></button>
        <button class="nav-btn" data-target="intel">Intel</button>
        <button class="nav-btn" data-target="map">Map</button>
        <button class="nav-btn" data-target="contact">Contact</button>
        <button class="nav-btn" data-target="Market">Market</button>
        <div style="width:4px"></div>
        <button id="loginBtn" class="nav-btn">ë¡œê·¸ì¸</button>
        <button id="soundToggle" class="nav-btn">ì‚¬ìš´ë“œ</button>
      </nav>
    </header>

    <!-- MAIN CONTENT -->
    <main style="margin-top:18px">
      <!-- HOME -->
      <section id="home" class="panel big">
        <div style="display:flex;justify-content:space-between;align-items:center;gap:12px">
          <div>
            <h2 style="font-size:22px;margin-bottom:6px">
              <span class="glitch" data-text="NeoRivere â€” ë’·ê³¨ëª©ì—ì„  ìš°ë¦¬ëŠ” ë²•ë³´ë‹¤ ë¹ ë¥´ë‹¤">
                NeoRivere â€” ë’·ê³¨ëª©ì—ì„  ìš°ë¦¬ëŠ” ë²•ë³´ë‹¤ ë¹ ë¥´ë‹¤
              </span>
            </h2>
            <p class="small">ë¸Œë¡œì»¤ë¡œì„œ í•„ìš”í•œ ëª¨ë“  ë„êµ¬ë¥¼ í•œ ê³³ì—.</p>
            <div style="margin-top:8px;color:var(--muted);font-size:13px">
              ê²½ê³ : ì •ë¶€ì˜ ê°ì‹œê°€ ê°•â–ˆâ–ˆìŠµë‹ˆë‹¤. ì€â–ˆí•˜ê²Œ í–‰â–ˆâ–ˆì„¸ìš”.
            </div>
          </div>

          <div class="world-ticker">
            <span class="label">[NEORIVERE STATUS]</span>
            <span id="worldTickerText"></span>
          </div>          

          <div class="controls">
            <div style="text-align:right">
              <div style="background:rgba(0,0,0,0.4);padding:8px;border-radius:12px;margin-top:0px" id="wallet">5000 creds</div>
            </div>
            <button id="postJob" class="btn">ì˜ë¢° ì˜¬ë¦¬ê¸°</button>
          </div>
        </div>

        <div class="grid" style="margin-top:16px">
          <div class="panel" id="profPanel">
            <h3>ë¸Œë¡œì»¤ í”„ë¡œí•„</h3>
            <p class="small">í”„ë¡œí•„ì„ ì„¤ì •í•˜ê³  ì‹ ë¢° ì ìˆ˜ë¥¼ ìŒ“ìœ¼ì„¸ìš”. (ë¡œì»¬ ì €ì¥)</p>
            <div style="margin-top:10px;color:var(--muted);font-size:13px">í˜„ì¬ ë¡œê·¸ì¸: <span id="who">ì—†ìŒ</span></div>
          </div>

          <div class="panel" id="blackPanel">
            <h3>ì•”ì‹œì¥</h3>
            <p class="small">ì•„ì´í…œ ë¼ì¸ì—…ê³¼ êµ¬ë§¤. ìµëª… íŠ¸ëœì­ì…˜ì€ ì‹¤í—˜ì ì…ë‹ˆë‹¤.</p>
          </div>

          <div class="panel" id="connPanel">
            <h3>ì—°ê²° í¬í„¸</h3>
            <p class="small">ì˜ë¢° ë“±ë¡ê³¼ ì§ì ‘ ì—°ê²° â€” ìµëª… ì˜µì…˜ í¬í•¨.</p>
          </div>

          <div class="panel" id="secretPanel">
            <h3>ë¹„ë°€ íŒì—…</h3>
            <p class="small">ì˜¤ì§ <strong id="secret-owner">raven</strong> ì „ìš©ì…ë‹ˆë‹¤.</p>
            <div style="margin-top:8px;color:var(--muted)">í˜„ì¬ ë¹„ë°€ íŒì—… ìƒíƒœ: <span id="secretState">ì ê¹€</span></div>
          </div>
        </div>

        <button id="pulseScan" class="btn" style="margin-top:10px">í„ìŠ¤ ìŠ¤ìº”</button>
        <button id="darkTrace" class="btn secondary" style="margin-top:10px">ë‹¤í¬ íŠ¸ë ˆì´ìŠ¤</button>

        <div style="margin-top:16px" class="panel">
          <h3><span class="glitch" data-text="ìµœê·¼ í™œë™">ìµœê·¼ í™œë™</span></h3>
          <p class="small">ì‚¬ëŒë“¤ì´ ìš°ë¦¬ì—ê²Œ ë‚¨ê¸´ ì˜ë¢°(ìƒ˜í”Œ) ë° í˜„ì¬ ì˜¤í”ˆëœ ì˜ë¢°ë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤.</p>

          <div class="stats" style="margin-top:12px">
            <div class="stat">
              <div class="num" id="completed-count">0</div>
              <div class="small" style="color:var(--muted)">ì´ ì™„ë£Œ ì˜ë¢°</div>
            </div>
            <div class="stat">
              <div class="num" id="open-count">0</div>
              <div class="small" style="color:var(--muted)">ì˜¤í”ˆ ì˜ë¢°</div>
            </div>
            <div class="stat">
              <div class="num" id="wallet-count">5000</div>
              <div class="small" style="color:var(--muted)">ì§€ê°‘ (creds)</div>
            </div>
          </div>

          <div style="margin-top:14px">
            <h4 style="margin:0 0 8px 0">ìµœê·¼ ì˜ë¢° (ì‚¬ìš©ì ì œì¶œ ì˜ˆì‹œ)</h4>
            <div id="recent-list" class="list"></div>
          </div>
        </div>

        <div style="margin-top:16px" class="panel">
          <h3><span class="glitch" data-text="ì‚¬ë¬´ì†Œ ì¸ë¬¼ ë¸Œë¦¬í•‘">ì‚¬ë¬´ì†Œ ì¸ë¬¼ ë¸Œë¦¬í•‘</span></h3>
          <p class="small">
            ì˜µì‹œë””ì–¸ ë””ë ‰í‹°ë¸Œì˜ í•µì‹¬ ì¸ë¬¼ë“¤.  
            ì™¸ë¶€ ê¸°ë¡ì—ëŠ” ë‚¨ì§€ ì•ŠëŠ”, ë„¤ì˜¤ë¦¬ë² ë¥´ ë’·ê³¨ëª©ì˜ ì§„ì§œ ì£¼ì¸ë“¤ì´ë‹¤.
          </p>

          <div class="staff-grid">
            <!-- ì…€ë ˆë¥´ë‹ˆì•„ -->
            <article class="staff-card">
              <div class="staff-header">
                <div>
                  <div class="staff-name">ì…€ë ˆë¥´ë‹ˆì•„</div>
                  <div class="staff-role">Obsidian Directive ëŒ€í‘œ Â· ë©”ì¸ ë¸Œë¡œì»¤</div>
                </div>
                <div class="staff-pill">LV.BLACK Â· ROOT ACCESS</div>
              </div>
              <div class="staff-tagline">
                â€œë„ì‹œì˜ ëª¨ë“  ë¹„ë°€ì€, ê²°êµ­ ë‚´ ì±…ìƒ ìœ„ë¡œ ëª¨ì¸ë‹¤.â€
              </div>
              <div class="staff-body">
                ë„¤ì˜¤ë¦¬ë² ë¥´ ë’·ì„¸ê³„ì˜ ìµœìƒìœ„ ê¶Œë ¥.  
                ê°ì‹œë§ì˜ ë¹ˆ í‹ˆ, ì‚¬ëŒë“¤ì˜ ì•½ì , ë°ì´í„° íë¦„ì˜ ë°©í–¥ê¹Œì§€
                ë¨¸ë¦¿ì†ì— ì§€ë„ì²˜ëŸ¼ ê·¸ë ¤ë‘ê³  ì›€ì§ì¸ë‹¤.
              </div>
              <div class="staff-meta">
                <span>ì „ë¬¸ ë¶„ì•¼: ì •ë³´ ë¸Œë¡œì»¤ë§ / ë„¤íŠ¸ì›Œí¬ ì¡°ì‘</span>
                <span>ìœ„í—˜ë„: â˜…â˜…â˜…â˜…â˜…</span>
              </div>
            </article>

            <!-- NSB ì¶œì‹  ì†Œë…„ ì„œí¬í„° -->
            <article class="staff-card">
              <div class="staff-header">
                <div>
                  <div class="staff-name">ì½”ë“œë„¤ì„: ìŠ¤ìºë„ˆ</div>
                  <div class="staff-role">ì „ NSB ê°ì‹œêµ­ Â· ì„œí¬í„°</div>
                </div>
                <div class="staff-pill">AGE: LATE TEEN</div>
              </div>
              <div class="staff-tagline">
                â€œì›ë˜ëŠ” ë„ˆí¬ë¥¼ ê°ì‹œí•˜ë¼ê³  ë°°ì› ëŠ”ë°, ì´ì œëŠ” ê°™ì´ ë„ë§ì¹˜ëŠ” ìª½ì´ ë” ì¬ë°Œì–´.â€
              </div>
              <div class="staff-body">
                10ëŒ€ í›„ë°˜ì˜ ì†Œë…„. ì›ë˜ NSB ì†Œì† ê°ì‹œêµ­ ë¶„ì„ ìš”ì›ì´ì—ˆì§€ë§Œ  
                ë„ˆë¬´ ë§ì€ ê²ƒì„ ì•Œì•„ë²„ë¦° íƒ“ì— â€œì˜¬ë“œ ì±„ë„â€ë¡œ ë²„ë ¤ì¡Œë‹¤.  
                ê·¸ë•Œ ì…€ë ˆë¥´ë‹ˆì•„ê°€ ì†ì„ ë‚´ë°€ì–´ ì‚¬ë¬´ì†Œë¡œ ë°ë ¤ì™”ë‹¤.
              </div>
              <div class="staff-meta">
                <span>ì—­í• : ê°ì‹œë§ íŒ¨í„´ ë¶„ì„ / ë¡œê·¸ ì¡°ì‘</span>
                <span>ì‹ ë¢°ë„: â˜…â˜…â˜…â˜…â˜†</span>
              </div>
            </article>

            <!-- ì…€ë ˆë¥´ë‹ˆì•„ í˜¸ìœ„ë¬´ì‚¬ -->
            <article class="staff-card">
              <div class="staff-header">
                <div>
                  <div class="staff-name">ì½”ë“œë„¤ì„: ë¸”ë ˆì´ë“œ</div>
                  <div class="staff-role">ì‚¬ë¬´ì†Œ ì „ì† í˜¸ìœ„ë¬´ì‚¬</div>
                </div>
                <div class="staff-pill">CLOSEÂ·COMBAT</div>
              </div>
              <div class="staff-tagline">
                â€œì§€ì›Œì•¼ í•  ê±´ ë°ì´í„°ë§Œì´ ì•„ë‹ˆë‹¤.â€
              </div>
              <div class="staff-body">
                ë§ìˆ˜ê°€ ì ê³ , ê¸°ë¡ë„ ê±°ì˜ ë‚¨ì•„ìˆì§€ ì•Šì€ ì¸ë¬¼.  
                ë„¤ì˜¨ ê³¨ëª© ëì—ì„œ ì†Œë¬¸ì²˜ëŸ¼ë§Œ ë“¤ë¦¬ë˜ â€œê²€ì€ í˜¸ìœ„ìâ€ì™€ ë™ì¼ ì¸ë¬¼ì´ë¼ëŠ” ì„¤ì´ ìˆë‹¤.  
                ì˜ë¢°ê°€ ì‹¤íŒ¨ ì§ì „ìœ¼ë¡œ ì¹˜ë‹¬ì„ ë•Œ, ë§ˆì§€ë§‰ì— íŒì„ ìˆ˜ìŠµí•˜ëŠ” ì—­í• .
              </div>
              <div class="staff-meta">
                <span>ì—­í• : ê·¼ì ‘ì „ / VIP ë³´í˜¸ / íšŒìˆ˜</span>
                <span>ëª©ê²© ê¸°ë¡: ê·¹íˆ í¬ë°•</span>
              </div>
            </article>
          </div>
        </div>

      </section>

      <!-- JOBS -->
            <!-- JOBS -->
            <section id="jobs" class="panel" style="display:none">
              <div class="nd-section-header">
                <div>
                  <h2>ì˜ë¢° ëª©ë¡</h2>
                  <p class="nd-section-caption">
                    ë„¤ì˜¤ë¦¬ë² ë¥´ ì „ì—­ì—ì„œ ìˆ˜ì§‘ëœ ì˜ë¢°ë“¤. ìœ„í—˜ë„ì™€ êµ¬ì—­ë³„ë¡œ í•„í„°ë§ë˜ëŠ”
                    <strong>ì˜µì‹œë””ì–¸ ë””ë ‰í‹°ë¸Œ ë‚´ë¶€ìš© ë¦¬ìŠ¤íŠ¸</strong>ì…ë‹ˆë‹¤.
                  </p>
                </div>
                <div class="nd-section-actions">
                  <input id="job-search"
                         placeholder="ê²€ìƒ‰: í•´í‚¹, ì ì…, ë°°ë‹¬..."
                         style="background:transparent;border:1px solid rgba(255,255,255,0.04);padding:8px;border-radius:8px;color:var(--text)" />
                  <button id="refreshJobs" class="btn micro">ê°±ì‹ </button>
                </div>
              </div>
      
              <!-- ì„¤ì •ì§‘ìš© ë­í¬ ì˜ë¢° 3ì¢… ìš”ì•½ -->
              <div class="nd-contract-grid">
                <article class="nd-contract-card nd-rank-s">
                  <div class="nd-contract-rank">S-RANK // BLACK OPS</div>
                  <div class="nd-contract-title">ë„ì‹œ êµ¬ì¡°ë¥¼ ë’¤í”ë“œëŠ” ê¸‰ì´ìƒì˜ ì˜ë¢°</div>
                  <div class="nd-contract-body">
                    ì •ê¶Œ êµì²´, ëŒ€ê·œëª¨ ë„¤íŠ¸ì›Œí¬ ë§ˆë¹„, ê³ ìœ„ ì¸ë¬¼ ì œê±° ê°™ì€
                    <strong>ë„ì‹œê¸‰ ì‚¬ê±´</strong>ì´ ì—¬ê¸°ì— ì†í•©ë‹ˆë‹¤.
                    ì‹¤íŒ¨ ì‹œ ë„¤ì˜¤ë¦¬ë² ë¥´ ì „ì²´ê°€ í”ë“¤ë¦¬ë¯€ë¡œ
                    ì…€ë ˆë¥´ë‹ˆì•„ì˜ ì§ì ‘ ìŠ¹ì¸ ì—†ì´ëŠ” ì—´ë¦¬ì§€ ì•ŠìŠµë‹ˆë‹¤.
                  </div>
                  <div class="nd-contract-meta">
                    <span>ê¶Œì¥ ì¸ì›: 3~5ì¸ ì…€ ë‹¨ìœ„</span>
                    <span>ë³´ìƒ: ìƒìƒ ì´ìƒ</span>
                  </div>
                </article>
      
                <article class="nd-contract-card nd-rank-a">
                  <div class="nd-contract-rank">A-RANK // CORE OPS</div>
                  <div class="nd-contract-title">ê¸°ì—… ìŠ¤íŒŒì´, í•µì‹¬ ìì‚° íƒˆì·¨</div>
                  <div class="nd-contract-body">
                    ê¸°ì—… íƒ€ì›Œ ì¹¨íˆ¬, ì¤‘ìš” ì¸ë¬¼ í˜¸ì†¡, ì‹¤í—˜ì²´ íšŒìˆ˜ ë“±
                    <strong>ë„ì‹œ í•µì‹¬ ì¸í”„ë¼</strong>ë¥¼ ê±´ë“œë¦¬ëŠ” ì˜ë¢°.
                    ì˜µì‹œë””ì–¸ ë””ë ‰í‹°ë¸Œì˜ ë©”ì¸ ìˆ˜ìµì›ìœ¼ë¡œ,
                    ì‹ ë¢°ë„ ë†’ì€ ë¸Œë¡œì»¤ì—ê²Œ ìš°ì„  ë°°ì •ë©ë‹ˆë‹¤.
                  </div>
                  <div class="nd-contract-meta">
                    <span>ê¶Œì¥ ì¸ì›: 2~3ì¸</span>
                    <span>í‰ê·  ë³´ìƒ: 1ë§Œ ~ 5ë§Œ creds</span>
                  </div>
                </article>
      
                <article class="nd-contract-card nd-rank-c">
                  <div class="nd-contract-rank">C-RANK // STREET OPS</div>
                  <div class="nd-contract-title">ë’·ê³¨ëª© ìƒí™œë°€ì°© ì˜ë¢°</div>
                  <div class="nd-contract-body">
                    ì‹¤ì¢…ëœ ë…¹ìŒ íŒŒì¼, ìœ„í—˜ êµ¬ì—­ ë°°ë‹¬, ì†Œê·œëª¨ ë³´ì•ˆ êµë€ ë“±.
                    <strong>í˜„ì¥ ê°ê°ì„ ìµíˆëŠ” ì—°ìŠµìš©</strong> ì˜ë¢°ë¡œ,
                    ì‹ ì… ë¸Œë¡œì»¤ë‚˜ ê²€ì¦ë˜ì§€ ì•Šì€ ì¸ì›ì—ê²Œ ë¨¼ì € ëŒì•„ê°‘ë‹ˆë‹¤.
                  </div>
                  <div class="nd-contract-meta">
                    <span>ê¶Œì¥ ì¸ì›: 1~2ì¸</span>
                    <span>í‰ê·  ë³´ìƒ: ìˆ˜ë°± ~ ìˆ˜ì²œ creds</span>
                  </div>
                </article>
              </div>
      
              <h3 style="margin:4px 0 6px 0;font-size:14px;">ì‹¤ì‹œê°„ ê²Œì‹œ ì˜ë¢°</h3>
      
              <div id="job-filters"
                   style="margin-top:6px;display:flex;gap:8px;flex-wrap:wrap">
                <button type="button" class="btn secondary micro job-filter"
                        data-status="all">ì „ì²´</button>
                <button type="button" class="btn secondary micro job-filter"
                        data-status="open">ì˜¤í”ˆ</button>
                <button type="button" class="btn secondary micro job-filter"
                        data-status="accepted">ì§„í–‰ì¤‘</button>
                <button type="button" class="btn secondary micro job-filter"
                        data-status="completed">ì™„ë£Œ</button>
              </div>
      
              <div id="jobs-list" style="margin-top:12px" class="list"></div>
            </section>
      
      <!-- INTEL -->
            <!-- INTEL -->
            <section id="intel" class="panel" style="display:none">
              <div class="nd-section-header">
                <div>
                  <h2>ì‹¤ì‹œê°„ ì¸í…” í”¼ë“œ</h2>
                  <p class="nd-section-caption">
                    ê°ì‹œë§ ë¡œê·¸, ì–¸ë”ë„· ë£¨ë¨¸, ì•”ì‹œì¥ ë¸Œë¦¬í•‘ì„ ì¡°í•©í•œ
                    <strong>NeoRivere ë¼ì´ë¸Œ ì •ë³´ ìŠ¤íŠ¸ë¦¼</strong>ì…ë‹ˆë‹¤.
                  </p>
                </div>
              </div>
      
              <div id="intel-list" class="nd-intel-grid"></div>
            </section>
      

            <!-- MAP -->
            <section id="map" class="panel" style="display:none">
              <div class="nd-section-header">
                <div>
                  <h2>NeoRivere êµ¬ì—­ ë§µ</h2>
                  <p class="nd-section-caption">
                    ì˜µì‹œë””ì–¸ ë””ë ‰í‹°ë¸Œ ì „ìš© <strong>ìœ„í—˜ë„ ë¸Œë¦¬í•‘ ë§µ</strong>.
                    êµ¬ì—­ì„ í´ë¦­í•˜ë©´ ìƒì„¸ ì •ë³´ê°€ ì˜¤ë¥¸ìª½ì— í‘œì‹œë©ë‹ˆë‹¤.
                  </p>
                </div>
              </div>
      
              <div class="nd-map-layout">
                <div class="nd-map-detail">
                  <div class="nd-map-detail-title" id="map-detail-name">NeoRivere</div>
                  <div class="nd-map-detail-level" id="map-detail-level">
                    ìœ„í—˜ë„ ë ˆë²¨ / ê°ì‹œ ê°•ë„
                  </div>
                  <div class="nd-map-detail-desc" id="map-detail-desc">
                    ì™¼ìª½ì˜ êµ¬ì—­ ì¹´ë“œ ì¤‘ í•˜ë‚˜ë¥¼ ì„ íƒí•˜ë©´, ì´ ìœ„ì¹˜ì˜ ì„¸ë¶€ ì„¤ëª…ì´ í‘œì‹œë©ë‹ˆë‹¤.
                  </div>
                  <div class="nd-map-detail-key" id="map-detail-key">
                    í•µì‹¬ í¬ì¸íŠ¸: -
                  </div>
                </div>

                <div class="nd-map-holo" id="map-holo">
                  <div class="nd-map-holo-label">HOLOÂ·ZONE PROJECTION</div>
                  <div class="nd-map-holo-name" id="map-holo-name">-</div>
                  <div class="nd-map-holo-meta" id="map-holo-meta">LV.- / status: -</div>
              
                  <div class="nd-map-holo-grid">
                    <div class="nd-map-holo-cell"></div>
                    <div class="nd-map-holo-cell"></div>
                    <div class="nd-map-holo-cell"></div>
                    <div class="nd-map-holo-cell"></div>
                    <div class="nd-map-holo-cell"></div>
                    <div class="nd-map-holo-cell"></div>
                    <div class="nd-map-holo-cell"></div>
                    <div class="nd-map-holo-cell"></div>
                  </div>
                </div>

                <!-- HOLO-ZONE ì•„ë˜ ì‘ì „ ìš”ì•½ ë°•ìŠ¤ -->
<div class="nd-map-ops" id="map-ops">
  <div class="nd-map-ops-title">ì‘ì „ ìš”ì•½</div>
  <div class="nd-map-ops-grid">
    <div class="ops-item">
      <div class="label">ê¶Œì¥ ì¥ë¹„</div>
      <div class="value" id="ops-gear">
        êµ¬ì—­ì„ ì„ íƒí•˜ë©´ ê¶Œì¥ ì¥ë¹„ê°€ í‘œì‹œë©ë‹ˆë‹¤.
      </div>
    </div>
    <div class="ops-item">
      <div class="label">ì¶œëª° ì„¸ë ¥</div>
      <div class="value" id="ops-faction">-</div>
    </div>
    <div class="ops-item">
      <div class="label">ë¸Œë¡œì»¤ ë©”ëª¨</div>
      <div class="value" id="ops-note">-</div>
    </div>
  </div>
</div>
      
                <div class="map-grid" id="map-grid"></div>
              </div>
            </section>
      

            <!-- CONTACT -->
            <section id="contact" class="panel" style="display:none">
              <h2>ì…€ë ˆë¥´ë‹ˆì•„ í†µì‹  í—ˆë¸Œ</h2>
              <p class="small">
                ì´ ì±„ë„ì€ ë„¤ì˜¤ë¦¬ë² ë¥´ì˜ ì£¼ì¸ì¸ <strong>ì…€ë ˆë¥´ë‹ˆì•„</strong>ë§Œ ì ‘ê·¼ ê°€ëŠ¥í•œ ë¹„ê³µê°œ í†µì‹  ë¡œê·¸ì…ë‹ˆë‹¤.
                ì‚¬ë¬´ì†Œ ì§ì›, ì˜ë¢°ì¸, ë³´ì•ˆêµ­ì˜ ì ë“¤ì´ ë‚¨ê¸´ ë©”ëª¨ë¥¼ í•œ ê³³ì—ì„œ ê´€ë¦¬í•©ë‹ˆë‹¤.
              </p>
      
              <div class="contact-layout">
                <!-- ì…€ë ˆë¥´ë‹ˆì•„ê°€ ë©”ëª¨ ë‚¨ê¸°ëŠ” ìª½ -->
                <div class="contact-composer">
                  <div style="font-size:12px;color:var(--muted);margin-bottom:4px;">
                    ëŒ€ìƒ
                  </div>
                  <select id="contact-recipient"
                          style="width:100%;background:transparent;border:1px solid rgba(255,255,255,0.08);padding:6px 8px;border-radius:8px;color:var(--text);font-size:12px;">
                    <option value="ì‚¬ë¬´ì†Œ ì§ì›">ì‚¬ë¬´ì†Œ ì§ì›</option>
                    <option value="ì˜ë¢°ì¸">ì˜ë¢°ì¸</option>
                    <option value="ë³´ì•ˆêµ­">NSC Â· ê°ì‹œë§</option>
                    <option value="ê¸°íƒ€">NMC</option>
                  </select>
      
                  <textarea id="contact-input"
                            placeholder="ë‚¨ê¸¸ ë©”ëª¨ë¥¼ ì ìœ¼ì„¸ìš”. (ì˜ˆ: Ghost Alley ìˆœì°° ë³´ê³ , ì˜ë¢°ìì—ê²Œ ë‹µì¥ ë“±)"
                            style="margin-top:8px;width:100%;height:120px;background:transparent;border:1px solid rgba(255,255,255,0.06);padding:10px;border-radius:8px;color:var(--text);font-size:13px;"></textarea>
      
                  <div style="margin-top:8px;display:flex;gap:8px;">
                    <button id="contact-send" class="btn micro">ë©”ëª¨ ê¸°ë¡</button>
                    <button id="contact-clear" class="btn secondary micro">ì…ë ¥ ì§€ìš°ê¸°</button>
                  </div>
      
                  <div style="margin-top:6px;font-size:11px;color:var(--muted);">
                    â€» ì´ ë¡œê·¸ëŠ” <strong>í˜„ì¬ ë¸Œë¼ìš°ì €ì—ë§Œ ë¡œì»¬ ì €ì¥</strong>ë©ë‹ˆë‹¤. ìƒˆë¡œê³ ì¹¨í•´ë„ ìœ ì§€ë©ë‹ˆë‹¤.
                  </div>
                </div>
      
                <!-- ì˜¤ë¥¸ìª½: ë¡œê·¸ ì°½ -->
                <div class="contact-log-panel">
                  <div class="contact-log-header">
                    <div class="contact-log-title">ìµœê·¼ ëŒ€í™” ë¡œê·¸</div>
                    <div class="contact-log-caption">
                      ì‚¬ë¬´ì†Œ ì§ì›, ì˜ë¢°ì¸, ë³´ì•ˆêµ­ ìª½ì—ì„œ ì…€ë ˆë¥´ë‹ˆì•„ì—ê²Œ ë‚¨ê¸´ ë©”ì‹œì§€ê°€ ì •ë¦¬ë©ë‹ˆë‹¤.
                    </div>
                  </div>
      
                  <div id="contact-log" class="contact-log-list">
                    <!-- JSë¡œ ì±„ì›Œì§ -->
                  </div>
                </div>
              </div>
      
              <!-- ğŸ” ê¸°ì¡´ ì•”í˜¸í™” ë„êµ¬ëŠ” 'ê³ ê¸‰ ê¸°ëŠ¥'ìœ¼ë¡œ ì ‘ì–´ë‘ê¸° (ë²„íŠ¼/ID ìœ ì§€) -->
              <details style="margin-top:14px;font-size:12px;color:var(--muted);">
                <summary style="cursor:pointer;">
                  ê³ ê¸‰ ê¸°ëŠ¥: ì‹¤í—˜ìš© ì•”í˜¸í™” ë„êµ¬ ì—´ê¸°
                </summary>
                <div style="margin-top:8px;display:flex;gap:12px;align-items:flex-start;">
                  <textarea id="payload"
                            placeholder="ì‹¤í—˜ìš© ì•”í˜¸í™” ë©”ì‹œì§€..."
                            style="width:100%;height:100px;background:transparent;border:1px solid rgba(255,255,255,0.04);padding:10px;border-radius:8px;color:var(--text);"></textarea>
                  <div style="display:flex;flex-direction:column;gap:6px;min-width:120px;">
                    <button id="encryptBtn" class="btn micro">ì•”í˜¸í™” & ë³µì‚¬</button>
                    <button id="decryptBtn" class="btn secondary micro">ë³µí˜¸í™”</button>
                    <button id="clearPayload" class="btn secondary micro">ì§€ìš°ê¸°</button>
                  </div>
                </div>
              </details>
            </section>      

      <!-- MARKET -->
      <section id="Market" class="panel" style="display:none">
        <div class="scroll-panel">
          <h2 class="section-title">ğŸ›’ Black Market Exchange</h2>
          <div class="item-list"></div>
        </div>
      </section>
    </main>

    <footer class="panel" style="margin-top:12px">
      <div style="display:flex;justify-content:space-between;align-items:center;gap:12px">
        <div style="color:var(--muted)">Â© 2098 NeoRivere</div>
        <div style="display:flex;gap:8px;align-items:center">
          <div style="font-size:12px;color:var(--muted)">ê¸€ë¦¬ì¹˜ ê°•ë„</div>
          <input id="glitchRange" type="range" min="0" max="6" value="2" style="width:140px" />
          <button id="showDev" class="btn micro">ì´ìŠ¤í„°ì—ê·¸</button>
        </div>
      </div>
    </footer>
  </div>

  <!-- Easter Egg button -->
  <div class="egg" title="SYSÂ·LAYER">
    <button id="eggBtn" style="padding:8px 10px;background:rgba(255,255,255,0.04);border-radius:8px;border:1px solid rgba(255,255,255,0.03);color:var(--muted)">SYSÂ·LAYER</button>
  </div>

  <!-- secret popup placeholder -->
  <div id="secretPopup" style="position:fixed;right:18px;bottom:92px;width:260px;background:rgba(0,0,0,0.8);border:1px solid rgba(0,255,150,0.12);padding:12px;border-radius:12px;display:none;z-index:60">
    <div style="color:var(--neon-emerald);font-weight:700;margin-bottom:8px">SECRET â€” ë¸Œë¡œì»¤ ì „ìš©</div>
    <div style="color:var(--muted);font-size:13px">ì´ ê³µê°„ì€ raven ì „ìš©ì…ë‹ˆë‹¤. ì™¸ë¶€ ë…¸ì¶œ ê¸ˆì§€.</div>
    <div style="margin-top:10px">
      <button id="clipSecret" class="btn micro">í´ë¦½ë³´ë“œ ë³µì‚¬(ë°ëª¨)</button>
    </div>
  </div>

  <script>
/* ===============================
   Data (jobs, intel, map, items)
   =============================== */
const SECRET_OWNER = 'raven';

const jobs = [
  { id: 'H-1001', title: "í—¬ë¦­ìŠ¤ ë¡œê·¸ ì •ë¦¬ â€” 'ì œë°œ ë¶€íƒí•´ìš”'", client: 'ê¹€. (ê°œì¸)', reward: 8000, tags: ['clean','forensics'], location: 'Mid-Arcology 3F', difficulty: 'Medium', desc: '"ì œ ì‹¤ìˆ˜ë¡œ ì—°êµ¬ì†Œ ì ‘ì† í”ì ì´ ë‚¨ì•˜ì–´ìš”. ì•„ì´ë“¤ ë•Œë¬¸ì— ì†Œë€ í”¼ìš°ê¸° ì‹«ìŠµë‹ˆë‹¤. ë¡œê·¸ì—ì„œ ì œ í”ì ì„ ì§€ì›Œì£¼ì„¸ìš”." â€” ê°œì¸ ì˜ë¢°ì¸', status: 'completed' },
  { id: 'H-1002', title: "ë¸”ë™ì…°ë„ìš° ì ì… â€” 'ê°€ì¡±ì„ êµ¬í•´ì£¼ì„¸ìš”'", client: 'ìµëª…', reward: 15000, tags: ['infiltrate','stealth'], location: 'Lower Docks', difficulty: 'High', desc: '"ë°°ì†¡ì°¨ë¡œ ìœ„ì¥í•´ì„œ êµ¬ì—­ì— ë“¤ì–´ê°€ì•¼ í•©ë‹ˆë‹¤. ë‚´ë¶€ì—ì„œ íŠ¹ì • ë´‰íˆ¬ë¥¼ íšŒìˆ˜í•´ì•¼ í•´ìš”. ì¹˜ëª…ìƒì€ ì ˆëŒ€ ì•ˆ ë©ë‹ˆë‹¤." â€” ìµëª…', status: 'completed' },
  { id: 'J-9001', title: "ë°ì´í„° ìŠ¤í‚¤ë° â€” ì—°êµ¬ì†Œ ë¡œê·¸ (ê¸´ê¸‰)", client: 'ìµëª…(ì—°êµ¬ì›)', reward: 12000, tags: ['hack','stealth'], location: 'Mid-Arcology 7F', difficulty: 'High', desc: '"ì €ëŠ” í•´ë‹¹ ì—°êµ¬ì†Œì˜ ë‚´ë¶€ ì—°êµ¬ì›ì´ì§€ë§Œ ë‚´ë¶€ ê³ ë°œìì…ë‹ˆë‹¤. íŠ¹ì • í”„ë¡œì íŠ¸ì˜ ë¡œê·¸(2098-09 ~ 2098-11)ë¥¼ ì™¸ë¶€ë¡œ ë¹¼ë‚¼ ìˆ˜ ìˆë‚˜ìš”? ì¦ê±°ê°€ í•„ìš”í•©ë‹ˆë‹¤. ë„¤íŠ¸ì›Œí¬ë¡œ ì ‘ê·¼ ê°€ëŠ¥í•˜ì§€ë§Œ ëª¨ë‹ˆí„°ë§ì´ ì‹¬í•´ìš”."', status: 'open' },
  { id: 'J-9002', title: "ìŠ¤í˜ì…œ íŒ¨í‚¤ì§€ ë°°ë‹¬ â€” 'ê¸‰í•©ë‹ˆë‹¤'", client: 'ì†Œí˜• ê°±', reward: 2300, tags: ['delivery','fast'], location: 'Neon Market, Sector 3', difficulty: 'Low', desc: '"ì •í•´ì§„ ì‹œê°„(23:10-23:30)ì— Aâ†’B ì§€ì ìœ¼ë¡œ íŒ¨í‚¤ì§€ ì „ë‹¬. ê²‰ìœ¼ë¡œ ë³´ê¸°ì—” ìŒì‹ ë°°ë‹¬ì²˜ëŸ¼. ê°ì‹œê°€ ë‚®ì€ ì‹œê°„ëŒ€ì…ë‹ˆë‹¤. ì°¨ëŸ‰ ì œê³µ ê°€ëŠ¥."', status: 'open' },
  { id: 'J-9003', title: "ì•„ì´ì–¸ í¬ê²Ÿ â€” í‘œì  íšŒìˆ˜ (ë¯¼ê°)", client: 'ê¸°ì—…ì²­ë¶€', reward: 48000, tags: ['extraction','high-risk'], location: 'Corporate Spire 12', difficulty: 'Very High', desc: '"íšŒì‚¬ì˜ ë‚´ë¶€ ì»¨íƒì—ì„œ í‘œì ì„ ì•ˆì „í•˜ê²Œ ë°ë ¤ì˜¤ê¸¸ ì›í•¨. ë¹„ì¹˜ëª…ì  ì œì•• ê¶Œì¥. ê²½í˜¸ì› ë‹¤ìˆ˜, ê¶Œí•œ í† í°ì´ í•„ìš”í•  ìˆ˜ë„ ìˆìŒ."', status: 'open' },
  { id: 'J-9101', title: "ìŠ¤ë§ˆíŠ¸ ì„¼ì„œ êµë€ â€” ì´ë²¤íŠ¸", client: 'ì–¸ë”ë„· í¬ëŸ¼', reward: 9000, tags: ['electronic','timing'], location: 'Neon Market', difficulty: 'Medium', desc: '"ì‹œì¥ êµ¬ì—­ Aì˜ ì„¼ì„œê°€ 30ì´ˆ ë™ì•ˆ ë©ˆì¶°ì•¼ í•©ë‹ˆë‹¤. ìƒì¸ë“¤ì´ ì¼ì‹œì ìœ¼ë¡œ ì§„ì—´ì„ ë°”ê¿€ ìˆ˜ ìˆë„ë¡ êµë€ ìŠ¤í¬ë¦½íŠ¸ ë°°í¬ í•„ìš”."', status: 'open' },
  { id: 'J-9102', title: "ì€ìƒ‰ íŒ¨ìŠ¤ ìœ„ì¡° â€” ì¶œì… í—ˆê°€", client: 'ì†Œë§¤ìƒ', reward: 4200, tags: ['forge','low-risk'], location: 'Lower Docks', difficulty: 'Low', desc: '"ì„ì‹œ ì¶œì…ì¦ì´ í•„ìš”í•©ë‹ˆë‹¤. ë‹¨ê¸°ê°„(4ì‹œê°„) ìœ íš¨í•œ ì¶œì… íŒ¨ìŠ¤ë¡œ, OCR ê²€ì¦ì„ ìš°íšŒí•  ìˆ˜ ìˆì–´ì•¼ í•©ë‹ˆë‹¤. ì‚¬ì§„ ë° ìµœì†Œ ì •ë³´ ì œê³µ ê°€ëŠ¥."', status: 'open' },
  { id: 'J-9201', title: "ìƒì–´ë²„ë¦° ë…¹ìŒ íšŒìˆ˜ â€” ì—„ë§ˆì˜ ëª©ì†Œë¦¬", client: 'ìµœ. (ì¼ë°˜)', reward: 3000, tags: ['recovery','sensitive'], location: 'Old Subway', difficulty: 'Low', desc: '"ì§€í•˜ì²  íì‡„ì—­ ê·¼ì²˜ì—ì„œ ë…¹ìŒíŒŒì¼ì„ ìƒì–´ë²„ë ¸ì–´ìš”. ì œê²Œ ì¤‘ìš”í•œ ëŒ€í™”ê°€ ë“¤ì–´ìˆìŠµë‹ˆë‹¤. ë°ì´í„° ë³µêµ¬ê°€ ê°€ëŠ¥í• ê¹Œìš”? í”ŒëŸ¬ê·¸ë‚˜ ë¬¼ë¦¬ì  ì ‘ê·¼ ë‘˜ ë‹¤ ê°€ëŠ¥í•©ë‹ˆë‹¤."', status: 'open' },
  { id: 'J-9301', title: "êµ¬ì—­ A-9 ë°©í™”ë²½ í¬ë™", client: 'ì–¸ë”ë„· ìµëª…', reward: 16000, tags: ['hack','network'], location: 'Arcology 9F', difficulty: 'High', desc: '"ê¸°ì—… ë°©í™”ë²½ì— êµ¬ ë²„ì „ ì·¨ì•½ì ì´ ìˆì–´ìš”. ê±°ê¸°ì„œ íŠ¹ì • ë¡œê·¸ë¥¼ êº¼ë‚´ì•¼ í•´ìš”. ì ‘ê·¼ ê²½ë¡œëŠ” ì§ì ‘ ì°¾ì•„ì•¼ í•©ë‹ˆë‹¤."', status: 'open' },
  { id: 'J-9302', title: "í¬ê·€ ëª¨ë“ˆ ë°€ìˆ˜", client: 'ë¸”ë£¨ë§ˆì¼“ ìƒì¸', reward: 7200, tags: ['smuggling','delivery'], location: 'NeoRivere North Gate', difficulty: 'Medium', desc: '"ì •ì‹ ìœ í†µì´ ê¸ˆì§€ëœ AI-ì½”ì–´ ëª¨ë“ˆì…ë‹ˆë‹¤. ìŠ¤ìº”ì— ê±¸ë¦¬ì§€ ì•Šë„ë¡ ìš´ë°˜í•´ì£¼ì„¸ìš”."', status: 'open' },
  { id: 'J-9303', title: "ì§€í•˜ì—°ê²°ë§ ì ì…", client: 'í•˜ì¸µ ê°±', reward: 9800, tags: ['infiltrate','stealth'], location: 'Tunnel Sector 4', difficulty: 'High', desc: '"ë³´ê¸‰ì°½ê³  ë¬¸ì„ ì—´ê¸° ìœ„í•œ í‚¤ë¥¼ íšŒìˆ˜í•´ì•¼ í•©ë‹ˆë‹¤. ì ë“¤ì˜ ì¥ë¹„ëŠ” êµ¬í˜•ì´ë¯€ë¡œ íšŒí”¼ ê°€ëŠ¥í•´ìš”."', status: 'open' },
  { id: 'J-9304', title: "êµ¬ì—­ C-11 ì‹¬ë¶€ë¦„", client: 'ì¼ë°˜ ì‹œë¯¼', reward: 900, tags: ['favor'], location: 'Block C-11', difficulty: 'Low', desc: '"ëª¸ì´ ë¶ˆí¸í•´ì„œ ê·¸ëŸ°ë°â€¦ ì´ ì•½ì„ ë³‘ì›ì— ì „ë‹¬í•´ì£¼ì‹¤ ìˆ˜ ìˆë‚˜ìš”? ê·¸ëƒ¥ ë¶€íƒë“œë¦½ë‹ˆë‹¤."', status: 'open' },
  { id: 'J-9305', title: "ë°ì´í„° íŒ¨í‚· ì€ë°€ ë°°ë‹¬", client: 'í”„ë¦¬ëœì„œ í•´ì»¤', reward: 4100, tags: ['delivery','hack'], location: 'Undernet Node 2', difficulty: 'Medium', desc: '"ëˆ„êµ¬ì—ê²Œë„ ë“¤í‚¤ì§€ ì•Šê³  ì´ íŒ¨í‚·ì„ Node 2ì— ì—…ë¡œë“œí•˜ì„¸ìš”. ë¡œê·¸ëŠ” ë‚¨ê¸°ì§€ ë§ˆì„¸ìš”."', status: 'open' },
  { id: 'J-9306', title: "êµ¬í˜• ë¡œë´‡ íšŒìˆ˜", client: 'íê³µì¥ ì—°êµ¬ê°€', reward: 18000, tags: ['extraction'], location: 'Factory Sector', difficulty: 'High', desc: '"ë‚¡ì€ ë³´ì¡° ë¡œë´‡ í•˜ë‚˜ê°€ í™€ë¡œ ê°€ë™ ì¤‘ì…ë‹ˆë‹¤. ë¬´ë ¥í™”í•˜ì§€ ë§ê³  ê°€ì ¸ì˜¤ì„¸ìš”."', status: 'open' },
  {
    id: "S-000X",
    title: "âš ï¸ ëˆ„ë½ëœ ê¸°ë¡ â€” 'ë„ˆí¬ê°€ ë³¼ê²Œ ì•„ë‹Œë°â€¦'",
    client: "UNKNOWN",
    reward: 0,
    tags: ["glitch","error","forbidden"],
    location: "??",
    difficulty: "???",
    desc: "ê¸°ë¡ ì ‘ê·¼ ì˜¤ë¥˜. ë°ì´í„° íŒŒì†. <span class='glitch' data-text='ì ‘ê·¼ ê¸ˆì§€'>ì ‘ê·¼ ê¸ˆì§€</span>â€¦",
    status: "open"
  }
];

const intel = [
  { id: 'I-1', title: 'ì‹œë‚´ CCTV ë£¨íŠ¸ ì¬ì¡°ì •', time: '2098-11-18 02:12', trust: 'B+', tag: 'surveillance', body: 'ì¤‘ì•™ í†µì œì‹¤ì´ ìƒˆ ìŠ¤ì¼€ì¤„ì„ ë°°í¬ â€” ê³¼ê±° ë£¨íŠ¸ì™€ ì°¨ì´ ìˆìŒ. ì•¼ê°„ íŒ¨í„´ ì£¼ì˜.' },
  { id: 'I-2', title: 'ë¸”ë£¨ë²„ë“œ ë“œë¡  ë°°ì¹˜', time: '2098-11-20 21:04', trust: 'A-', tag: 'aerial', body: 'íŠ¹ì • êµ¬ì—­ ìƒê³µì— ê°ì‹œ ë“œë¡ ì´ ëŠ˜ì–´ë‚¨. ì „ìì „ ì¥ë¹„ ë³´ìœ  ê°€ëŠ¥.' },
  { id: 'I-3', title: 'íë¸Œ ë…¸ë“œ ì¬ë°°ì¹˜', time: '2098-11-21 01:30', trust: 'A', tag: 'network', body: 'ê¸°ì—… ë…¸ë“œë“¤ì´ íŠ¸ë˜í”½ ìš°íšŒ ê²½ë¡œë¥¼ ì„¤ì • â€” íŠ¹ì • êµ¬ê°„ì— ë ˆì´í„´ì‹œ ê¸‰ì¦.' },
  { id: 'I-4', title: 'ì •ì²´ë¶ˆëª… í†µì‹  ì‹ í˜¸', time: '2098-11-22 05:20', trust: 'C+', tag: 'signal', body: 'ë„ì‹œ ë™ë¶€ì—ì„œ ë¹„ì¸ê°€ ì£¼íŒŒìˆ˜ íƒì§€ë¨. ì§§ì€ ê°„ì„­ ë° ë°˜ë³µë˜ëŠ” íŒ¨í„´ ì¡´ì¬.' },
  { id: 'I-5', title: 'ê°±ë‹¨ ê°„ ì¶©ëŒ ë°œìƒ', time: '2098-11-22 13:44', trust: 'B', tag: 'gang', body: 'Chrome Jungles ì¸ê·¼ì—ì„œ ë¬´ì¥ ê°±ë‹¨ ì¶©ëŒ. ì ‘ê·¼ ê¸ˆì§€ ê¶Œê³ .' },
  { id: 'I-6', title: 'ê¸°ì—… ìŠ¤íŒŒì´ í¬ì°©', time: '2098-11-23 01:02', trust: 'A', tag: 'corp', body: 'Corporate Spire ë‚´ë¶€ì—ì„œ ë‚´ë¶€ì ì˜ì‹¬ ì¸ë¬¼ ê°ì§€ë¨. CCTV ì¼ë¶€ ì‚­ì œ ê¸°ë¡ ì¡´ì¬.' },
  { id: 'I-7', title: 'ì§€í•˜ì²  ë…¸ë“œ ê¶Œí•œ ìƒìŠ¹ ì‹œë„', time: '2098-11-23 02:50', trust: 'A-', tag: 'network', body: 'Old Subway ë„¤íŠ¸ì›Œí¬ì—ì„œ ë¹„ì¸ê°€ ë£¨íŠ¸ ê¶Œí•œ ìš”ì²­ ë°œìƒ. ì°¨ë‹¨ë¨.' },
  {
    id: "I-X",
    title: "ERROR://FEED_CORRUPTED",
    time: "2098-11-29 ??",
    trust: "?",
    tag: "glitch",
    body: "<span class='glitch' data-text='ë°ì´í„° ì†ìƒ'>ë°ì´í„° ì†ìƒ</span>: ê°ì‹œ ë„¤íŠ¸ì›Œí¬ê°€ ë¹„ì •ìƒ ë£¨í”„ë¥¼ ìƒì„± ì¤‘."
  },
  {
    id: "I-1",
    title: "ì‹œë‚´ CCTV ë£¨íŠ¸ ì¬ì¡°ì •",
    time: "2098-11-18 02:12",
    trust: "B+",
    tag: "surveillance",
    body: "ì¤‘ì•™ í†µì œì‹¤ì´ ìƒˆ ìŠ¤ì¼€ì¤„ì„ ë°°í¬ â€” ê³¼ê±° ë£¨íŠ¸ì™€ ë‹¤ë¥¸ íšŒì „ ì£¼ê¸°. ì•¼ê°„ì— ê°ì‹œ ì‚¬ê°ì´ ì‚¬ë¼ì§„ êµ¬ê°„ì´ ìˆìŒ."
  },
  {
    id: "I-2",
    title: "ë¸”ë£¨ë²„ë“œ ë“œë¡  ë°°ì¹˜",
    time: "2098-11-20 21:04",
    trust: "A-",
    tag: "aerial",
    body: "íŠ¹ì • ìƒê³µì— ê°ì‹œ ë“œë¡ ì´ ëŠ˜ì–´ë‚¨. ì¼ë¶€ ê¸°ì²´ëŠ” ì „ìì „ ì¥ë¹„ë¥¼ íƒ‘ì¬í•œ ê²ƒìœ¼ë¡œ ì¶”ì •ë¨."
  },
  {
    id: "I-3",
    title: "íë¸Œ ë…¸ë“œ ì¬ë°°ì¹˜",
    time: "2098-11-21 01:30",
    trust: "A",
    tag: "network",
    body: "ê¸°ì—… ë…¸ë“œë“¤ì´ íŠ¸ë˜í”½ ìš°íšŒ ê²½ë¡œë¥¼ ì„¤ì •. íŠ¹ì • êµ¬ê°„ì—ì„œ ë ˆì´í„´ì‹œ ê¸‰ì¦, ë°ì´í„° ë¤í”„ ì‹œë„ ê°€ëŠ¥ì„±."
  },
  {
    id: "I-4",
    title: "ì •ì²´ë¶ˆëª… í†µì‹  ì‹ í˜¸",
    time: "2098-11-22 05:20",
    trust: "C+",
    tag: "signal",
    body: "ë„ì‹œ ë™ë¶€ì—ì„œ ë¹„ì¸ê°€ ì£¼íŒŒìˆ˜ íƒì§€. ì§§ê³  ë°˜ë³µë˜ëŠ” íŒ¨í„´ì´ë©°, êµ¬í˜• NMC ì¥ë¹„ì—ì„œ ì“°ë˜ í¬ë§·ê³¼ ìœ ì‚¬í•˜ë‹¤ëŠ” ë³´ê³ ."
  },
  {
    id: "I-5",
    title: "ê°±ë‹¨ ê°„ ì¶©ëŒ ë°œìƒ",
    time: "2098-11-22 13:44",
    trust: "B",
    tag: "gang",
    body: "Chrome Jungles ì¸ê·¼ì—ì„œ ë¬´ì¥ ê°±ë‹¨ ì¶©ëŒ. NMC ì°¨ëŸ‰ì´ í˜„ì¥ì„ ìŠ¤ì³ ì§€ë‚˜ê°”ì§€ë§Œ, ê³µì‹ ê¸°ë¡ì—ì„œëŠ” ì œì™¸ë¨."
  },
  {
    id: "I-6",
    title: "ê¸°ì—… ìŠ¤íŒŒì´ í¬ì°©",
    time: "2098-11-23 01:02",
    trust: "A",
    tag: "corp",
    body: "Corporate Spire ë‚´ë¶€ì—ì„œ ë‚´ë¶€ì ì˜ì‹¬ ì¸ë¬¼ ê°ì§€. NSC ìª½ì—ì„œ ë¡œê·¸ ì¼ë¶€ë¥¼ íšŒìˆ˜í–ˆìœ¼ë‚˜, ì´ë¦„ ì¹¸ë§Œ ê²€ê²Œ ë§ˆìŠ¤í‚¹ë¨."
  },
  {
    id: "I-7",
    title: "ì§€í•˜ì²  ë…¸ë“œ ê¶Œí•œ ìƒìŠ¹ ì‹œë„",
    time: "2098-11-23 02:50",
    trust: "A-",
    tag: "network",
    body: "Old Subway ë„¤íŠ¸ì›Œí¬ì—ì„œ ë¹„ì¸ê°€ ë£¨íŠ¸ ê¶Œí•œ ìš”ì²­ ë°œìƒ. ìš”ì²­ì íƒœê·¸: 'OBSIDIAN-DIR', ì²˜ë¦¬ ê²°ê³¼: ìˆ˜ë™ìœ¼ë¡œ ì°¨ë‹¨ë¨."
  },
  {
    id: "I-8",
    title: "NSC ë‚´ë¶€ ì±„ë„ ë¡œê·¸ ì¡°ê° ìœ ì¶œ",
    time: "2098-11-23 04:12",
    trust: "A",
    tag: "NSC",
    body: "NSC ë‚´ë¶€ ì±„ë„ì—ì„œ ì˜ë ¤ ë‚˜ê°„ ë¡œê·¸ ì¡°ê°ì´ ì–¸ë”ë„·ì— ë– ëŒê³  ìˆìŒ. ìˆ˜ì‹ ì ì¹¸ì— 'ì…€ë ˆë¥´ë‹ˆì•„'ë¼ëŠ” ë¬¸ìì—´ì´ ë‚¨ì•„ ìˆìœ¼ë‚˜, ìœ„ì— ê²€ì€ ë¸”ë¡ì´ ê²¹ì³ì ¸ ìˆìŒ."
  },
  {
    id: "I-9",
    title: "NMC ì•¼ê°„ ì •ë¹„ ë£¨íŠ¸ ì´ìƒ",
    time: "2098-11-23 05:33",
    trust: "B+",
    tag: "NMC",
    body: "NMC ì •ë¹„ë°˜ì´ Ghost Alleyì™€ Lower Docks ì‚¬ì´ êµ¬ê°„ì„ ë°˜ë³µ ìˆœíšŒ. ê³µì‹ ì •ë¹„ ì¼ì •ì—ëŠ” ì—†ëŠ” ë£¨íŠ¸ë¡œ, ë¬´ì—‡ì¸ê°€ë¥¼ ìˆ¨ê¸°ê±°ë‚˜ íšŒìˆ˜ ì¤‘ì¼ ê°€ëŠ¥ì„±ì´ ë†’ìŒ."
  }
];

const mapZones = [
  { id: 'Z-1', name: 'Neon Market', level: 2, hazard: 'medium', desc: 'ìƒì ê³¼ ì•”ì‹œì¥ í˜¼ì¬. ê°ì‹œ ë¹ˆë„ëŠ” ë‚®ìŒ.', key: 'í›„ë¯¸ ê³¨ëª©ì˜ ìƒì ì°½ê³  â€” êµí™˜ í¬ì¸íŠ¸' },
  { id: 'Z-2', name: 'Mid-Arcology', level: 5, hazard: 'high', desc: 'ê³ ì¸µ ì—°êµ¬/ê¸°ì—… êµ¬ì—­. ë³´ì•ˆ ë ˆì´ì–´ê°€ ë¹½ë¹½í•¨.', key: 'ë³´ì•ˆ ì—˜ë¦¬ë² ì´í„° ë£¨íŠ¸ê°€ í•µì‹¬' },
  { id: 'Z-3', name: 'Lower Docks', level: 3, hazard: 'variable', desc: 'ë°°í›„ ê±°ë˜ì™€ ì†Œê·œëª¨ ê°± í™œë™. ì•¼ê°„ì´ í™œë°œí•¨.', key: 'ì»¨í…Œì´ë„ˆ ì‚¬ì´ ì€ë°€í•œ í†µë¡œ' },
  { id: 'Z-4', name: 'Old Subway', level: 2, hazard: 'low', desc: 'ì¸ì ì´ ë“œë¬¸ ì§€í•˜ í†µë¡œ â€” ì „ì ê°ì‹œ êµ¬ë©ì´ ë§ìŒ.', key: 'íì‡„ì—­ í”Œë«í¼ B' },
  { id: 'Z-5', name: 'Corporate Spire', level: 6, hazard: 'very high', desc: 'ê¸°ì—… í•µì‹¬ êµ¬ì—­ â€” ì ‘ê·¼ì‹œ í—ˆê°€ í•„ìš”.', key: 'ì˜¥ìƒ í†µì‹  ë…¸ë“œ' },
  { id: 'Z-6', name: 'Ghost Alley', level: 4, hazard: 'extreme', desc: 'ì‹¤ì¢… ì‹ ê³ ê°€ ë°˜ë³µë˜ëŠ” êµ¬ì—­. ì „íŒŒ ê°„ì„­ ì‹¬í•¨.', key: 'ë…¹ìŠ¨ ì „ì‹ ì£¼ ì•„ë˜' },
  { id: 'Z-7', name: 'Chrome Jungles', level: 6, hazard: 'very high', desc: 'ë°˜ê¸ˆì† ìƒì²´ì‹¤í—˜ í”ì . ì ‘ê·¼ ì‹œ ì‹ í˜¸ ì™œê³¡.', key: 'íë‹¨ì§€ ë‚´ë¶€ ì‹¤í—˜ì‹¤' },
  { id: 'Z-8', name: 'Holo District', level: 3, hazard: 'medium', desc: 'í™€ë¡œê·¸ë¨ ê´‘ê³ ì™€ ê°€ì§œ êµ¬ì¡°ë¬¼ íˆ¬ì„±ì´. ì‹œì•¼ êµë€ ë†’ìŒ.', key: 'ê´‘ê³ íŒ¨ë„ ë’¤ ìˆ¨ê²¨ì§„ ìœ ì§€ë³´ìˆ˜ í†µë¡œ' },
  { id: 'Z-9', name: 'Echo Labyrinth', level: 5, hazard: 'high', desc: 'ì†Œë¦¬ ë°˜ì‚¬ êµ¬ì¡° ì§€í•˜ ë¯¸ë¡œ. GPS í˜¼ì„  ì‹¬ê°.', key: 'ìŒí–¥ ë°˜ì‚¬ì  ê·¼ì²˜, ë¹„ë°€ ì²´í¬í¬ì¸íŠ¸' },
  { id: 'Z-10', name: 'Blackwater Sewage', level: 6, hazard: 'extreme', desc: 'í•˜ìˆ˜ì™€ ì‚°ì—… íê¸°ë¬¼ì´ ì„ì´ëŠ” ì§€ì €ë¶„í•œ êµ¬ì—­.', key: 'íìˆ˜ ì²˜ë¦¬ì„¼í„° ë’¤ìª½ ì ê¸ˆ ë°¸ë¸Œ' },
  { id: 'Z-11', name: 'Skybridge Arrays', level: 4, hazard: 'variable', desc: 'ê³ ì¸µ ì‚¬ì´ ê°€êµë“¤ì´ ì—°ê²°ëœ ê²½ë¡œ. ë‚™í•˜ ì£¼ì˜.', key: 'ë™ìª½ ë¸Œë¦¿ì§€ ëë‹¨ ì „ìíŒ¨ë„' },
  { id: 'Z-12', name: 'Silent Clinic', level: 2, hazard: 'low', desc: 'ë²„ë ¤ì§„ ì˜ë£Œì‹œì„¤. ì „ì›ì´ ëŠê¸´ ê¸°ê³„ë“¤ë¿.', key: 'ì§„ë£Œì‹¤ 4ë²ˆ ë’¤ ìºë¹„ë„·' },
  { id: 'Z-13', name: 'Nova Plant', level: 6, hazard: 'very high', desc: 'ì—ë„ˆì§€ ê³µì¥. ê³ ì•• ì¥ì¹˜ ë‹¤ìˆ˜.', key: 'ëƒ‰ê°ìˆ˜ ì¡°ì ˆ í„°ë¯¸ë„' },
  {
    id: "Z-X",
    name: "Ghost Frequency Zone",
    level: 9,
    hazard: "unknown",
    desc: "ì „íŒŒì™€ í˜„ì‹¤ì´ ê²¹ì¹œë‹¤. ë“œë¡ ê³¼ ì¸ê°„ ëª¨ë‘ ì„¼ì„œ ì˜¤ë¥˜ ë°œìƒ.",
    key: "<span class='glitch' data-text='!! ì ‘ê·¼ ê¸ˆì§€ !!'>!! ì ‘ê·¼ ê¸ˆì§€ !!</span>"
  }
];

const items = [
  { id: 'IT-1', name: 'ì‹œê·¸ë„ ìŠ¤í¬ë¨ë¸”ëŸ¬', desc: 'ë‹¨ì‹œê°„ ë“œë¡ /ê°ì‹œì™€ í†µì‹  ì°¨ë‹¨', price: 1800, stock: 3 },
  { id: 'IT-2', name: 'Temp ID Chip', desc: 'ì„ì‹œ ì¶œì…ì¦ ì—ë®¬ë ˆì´í„°', price: 950, stock: 8 },
  { id: 'IT-3', name: 'EMP íŒ©(ì†Œí˜•)', desc: 'ì „ìê¸° í„ìŠ¤ë¡œ ì¥ë¹„ ë§ˆë¹„', price: 4200, stock: 1 },
  { id: 'IT-4', name: 'ìŠ¤í…”ìŠ¤ í•„ë¦„', desc: 'ì¹´ë©”ë¼Â·ì„¼ì„œ íˆ¬ëª…í™” íš¨ê³¼ 40ì´ˆ', price: 3200, stock: 5 },
  { id: 'IT-5', name: 'ë‚˜ë…¸ ë½í”½', desc: 'ê³ ê¸‰ ìë¬¼ì‡ /íŒ¨ë„ ì¹¨íˆ¬', price: 2700, stock: 6 },
  { id: 'IT-6', name: 'ìŠ¤í™íŠ¸ëŸ¼ í‚¤', desc: 'ë³´ì•ˆ íŒ¨ë„ ì»¬ëŸ¬ ì‹œí”„íŠ¸ ìš°íšŒ', price: 1500, stock: 10 },
  { id: 'IT-7', name: 'EMP ë§(ì¤‘í˜•)', desc: 'ë°˜ê²½ 6m ì „ìì¥ 1íšŒ ì°¨ë‹¨', price: 6300, stock: 2 },
  { id: 'IT-8', name: 'ì§€ë¬¸ í¬ê±°', desc: 'ì§€ë¬¸ í”ì  ìë™ ìœ„ì¡° ë° ì œê±°', price: 1100, stock: 12 },
  { id: 'IT-9', name: 'EX-íŒ¨í‚· ì¸ì í„°', desc: 'ë„¤íŠ¸ì›Œí¬ ìŠ¤í‘¸í•‘ í‚¤íŠ¸', price: 4800, stock: 3 },
  { id: 'IT-10', name: 'ì–¸ë”ë¡œë“œ íŒ¨ìŠ¤', desc: 'ì§€í•˜ êµ¬ê°„ ì´ë™ìš© ìµëª… íŒ¨ìŠ¤', price: 900, stock: 8 },
  { id: 'IT-11', name: 'ê³ ìŠ¤íŠ¸ ë¼ìš°í„°',       desc: 'íŠ¸ë˜í”½ì„ ì—¬ëŸ¬ ê°€ì§œ ë…¸ë“œë¡œ ë¶„ì‚°',      price: 5200, stock: 4 },
  { id: 'IT-12', name: 'ë°”ì´ì˜¤ ì‹ ë¶„ íŒ¨ì¹˜',    desc: 'ì§€ë¬¸Â·ë§¥ë°• íŒ¨í„´ 30ë¶„ê°„ ìœ„ì¥',           price: 3900, stock: 5 },
  { id: 'IT-13', name: 'ë“œë¡  ì¬í”„ë¡œê·¸ë¨ í‚¤íŠ¸',desc: 'ìƒì—…ìš© ë“œë¡  ì¼ì‹œì  ì œì–´ íƒˆì·¨',        price: 6100, stock: 2 },
  { id: 'IT-14', name: 'í™”ì´íŠ¸ ë…¸ì´ì¦ˆ ë¹„ì»¨',  desc: 'ì£¼ë³€ 5m ê°ì²­Â·ë„ì²­ ì¥ë¹„ êµë€',          price: 2500, stock: 7 },
  { id: 'IT-15', name: 'í•˜ì´ì¬í‚¹ ê¸€ëŸ¬ë¸Œ',     desc: 'ê·¼ì ‘ NFC/ìŠ¤ë§ˆíŠ¸ë½ ê°•ì œ í•¸ë“œì…°ì´í¬',    price: 3400, stock: 4 },
  { id: 'IT-16', name: 'ë¡œìš°íŒŒì›Œ EMP ì¹©',     desc: 'ì†Œí˜• ì¥ë¹„ë§Œ ì„ íƒì ìœ¼ë¡œ ë§ˆë¹„',         price: 2600, stock: 6 },
  { id: 'IT-17', name: 'ì‹ í˜¸ ì”ìƒ ìƒì„±ê¸°',    desc: 'ê°€ì§œ ìœ„ì¹˜Â·ì´ë™ ê²½ë¡œë¥¼ ë¡œê·¸ì— ë‚¨ê¹€',    price: 4500, stock: 3 },
  { id: 'IT-18', name: 'ì„€ë„ìš° ìº¡ìŠ',         desc: 'ëª¸ì— ë¶€ì°©í•˜ëŠ” ë‹¨ì‹œê°„ ì—´ ì‹ í˜¸ ì°¨ë‹¨ ìº¡ìŠ',price: 3700, stock: 5 },
];

const defaultContactLog = [
  {
    id:'L-1',
    from:'ì‚¬ë¬´ì†Œ ì§ì› Â· NSC ì¶œì‹  ì„œí¬í„°',
    to:'ì…€ë ˆë¥´ë‹ˆì•„',
    kind:'staff',
    time:'2098-11-22 03:14',
    body:'ë³´ì•ˆêµ­ ë‚´ë¶€ë§ì—ì„œ ì˜µì‹œë””ì–¸ ë””ë ‰í‹°ë¸Œ ê´€ë ¨ í‚¤ì›Œë“œê°€ ê³„ì† ëœ¨ê³  ìˆì–´ìš”. ë¡œê·¸ëŠ” ìµœëŒ€í•œ ì§€ì› ëŠ”ë°, íŒ¨í„´ì´ ì¢€ ì´ìƒí•©ë‹ˆë‹¤.'
  },
  {
    id:'L-2',
    from:'ì˜ë¢°ì¸ Â· "ì—„ë§ˆì˜ ëª©ì†Œë¦¬" ì˜ë¢°ì',
    to:'ì…€ë ˆë¥´ë‹ˆì•„',
    kind:'client',
    time:'2098-11-22 09:47',
    body:'ì§€í•˜ì²  íì‡„ì—­ ê·¼ì²˜ì—ì„œ ë…¹ìŒ íŒŒì¼ì„ ì°¾ì•˜ë‹¤ëŠ” ì—°ë½, ì˜ ë°›ì•˜ìŠµë‹ˆë‹¤. ì œ ìª½ ê¸°ë¡ì€ ì•½ì†ëŒ€ë¡œ ëª¨ë‘ ì§€ì›Œ ì£¼ì„¸ìš”.'
  },
  {
    id:'L-3',
    from:'ì‚¬ë¬´ì†Œ í˜¸ìœ„ë¬´ì‚¬',
    to:'ì…€ë ˆë¥´ë‹ˆì•„',
    kind:'staff',
    time:'2098-11-22 18:01',
    body:'ì˜¤ëŠ˜ ë°¤ Ghost Alley êµ¬ì—­ì€ í‰ì†Œë³´ë‹¤ ì¡°ìš©í•©ë‹ˆë‹¤. ëŒ€ì‹  í•˜ëŠ˜ì— ë„ëŠ” ë“œë¡  ìˆ˜ê°€ ì¡°ê¸ˆ ëŠ˜ì—ˆìŠµë‹ˆë‹¤.'
  },
  {
    id:'L-4',
    from:'[ë³´ì•ˆêµ­ ê°ì‹œ ë¡œê·¸ ì¡°ê°]',
    to:'ì…€ë ˆë¥´ë‹ˆì•„',
    kind:'enemy',
    time:'2098-11-23 00:12',
    body:'â€¦NEORIVERE NODE ì ‘ì† ê¸°ë¡ íƒì§€â€¦\nì‹ ì›: ë¹„ì‹ë³„. íƒœê·¸: "ì…€ë ˆë¥´ë‹ˆì•„" (ë¹„ê³µì‹ ì½”ë“œë„¤ì„). ë¶„ì„ ëŒ€ê¸° ì¤‘.'
  },
  {
    id: "L-5",
    timestamp: "2098-11-22 03:14",
    from: "SYSTEM // UNDERNET ROUTER",
    channel: "[SYS//NEORIVERE-ROUTER]",
    body: "NSC ë©”ì¸ ë…¸ë“œê°€ í•˜ì¸µ ì–¸ë”ë„·ì—ì„œ ë¹„ì¸ê°€ ë¸Œë¡œì»¤ ì„¸ì…˜ì„ íƒì§€í–ˆìŠµë‹ˆë‹¤. ìˆ˜ì‹ ì íƒœê·¸: 'ì…€ë ˆë¥´ë‹ˆì•„'. ë¼ìš°íŒ… í…Œì´ë¸” ìˆ˜ë™ ìˆ˜ì •ìœ¼ë¡œ ì¶”ì ì´ ì‹¤íŒ¨í–ˆë‹¤ëŠ” ê¸°ë¡ë§Œ ë‚¨ê²¨ì¡ŒìŠµë‹ˆë‹¤."
  },
  {
    id: "L-6",
    timestamp: "2098-11-22 03:40",
    from: "NSC-KID",
    channel: "[STAFF//NSC-KID]",
    body: "ë³´ìŠ¤, NSC ìƒì¸µ ë¡œê·¸ ì¼ë¶€ë¥¼ ë¹¼ ì™”ì–´ìš”. NMC ì•¼ê°„ ì •ë¹„ ë£¨íŠ¸ë‘ ê²¹ì¹˜ëŠ” ì‹œê°„ëŒ€ì—ë§Œ CCTVê°€ ë™ì‹œì— 3ëŒ€ì”© ëˆˆì„ ê°ì•„ìš”. ì´ê±´ ìš°ì—°ì´ ì•„ë‹ˆì—ìš”. í•„ìš”í•˜ë©´ ì›ë³¸ ë¡œê·¸ë„ ì˜¬ë ¤ë‘˜ê²Œìš”."
  },
  {
    id: "L-7",
    timestamp: "2098-11-22 04:02",
    from: "NMC í˜„ì¥ ì •ë¹„ë°˜",
    channel: "[NMC-FIELD-03]",
    body: "ê³µì‹ ë³´ê³ ì„œëŠ” NSC ìª½ìœ¼ë¡œë§Œ ì˜¬ë¼ê°€ë‹ˆê¹Œ, ì—¬ê¸°ì—ëŠ” ì§„ì§œ ìƒí™©ì„ ë‚¨ê²¨ë‘˜ê²Œìš”. Ghost Alley ë°°ì„  ë’¤ì—ì„œ ëˆ„êµ°ê°€ ì„¤ì¹˜í•´ ë‘” ë¹„ì¸ê°€ ë¼ì¸ì„ ë°œê²¬í–ˆëŠ”ë°, ì¶”ì  íƒœê·¸ì— 'OBSIDIAN-DIR'ê°€ ì°í˜€ ìˆì—ˆì–´ìš”. ìš°ë¦° ëª» ë³¸ ê±¸ë¡œ í•˜ê² ìŠµë‹ˆë‹¤."
  },
  {
    id: "L-8",
    timestamp: "2098-11-22 04:33",
    from: "ìµëª… ì˜ë¢°ì",
    channel: "[CLIENT//ANON]",
    body: "NMC ì •ë¹„ ì¼ì •ì´ ì—…ë°ì´íŠ¸ë˜ê¸° ì „ì— ì›€ì§ì—¬ì•¼ í•´ìš”. NSCê°€ ì œ ê°€ì¡±ì„ 'ë³´í˜¸ ëŒ€ìƒ'ìœ¼ë¡œ ì˜¬ë ¤ë²„ë ¸ìŠµë‹ˆë‹¤. ê·¸ ë§ì€ ê³§ ê°ì‹œ ëŒ€ìƒì´ë¼ëŠ” ëœ»ì´ê±°ë“ ìš”. ì ‘ì„  ì‹œê°„ê³¼ ì¥ì†ŒëŠ” ì œê°€ ì§€ì •í•˜ëŠ” ëŒ€ë¡œ, ë‹¨ í•œ ë²ˆë§Œ."
  },
  {
    id: "L-9",
    timestamp: "2098-11-22 05:10",
    from: "OLD CH. ê¸°ë¡ ì¡°ê°",
    channel: "[OLD-CHANNEL//FRAGMENT]",
    body: "â€¦NSC ê°€ë™ ì „, NMCê°€ ì²˜ìŒìœ¼ë¡œ ë„ì‹œ í•˜ì¸µì„ ë´‰ì¸í•˜ë˜ ë‚  ë‚¨ê²¨ì§„ ë¡œê·¸ì…ë‹ˆë‹¤. 'ì…€ë ˆë¥´ë‹ˆì•„, ë„¤ê°€ ì´ ë„ì‹œì˜ ë§ˆì§€ë§‰ ë°±ì—…ì´ ë  ê±°ì•¼.' ë¼ëŠ” ë¬¸ì¥ë§Œ ë‚¨ê³  ë‚˜ë¨¸ì§€ëŠ” ì „ë¶€ ê²€ê²Œ íƒœì›Œì¡ŒìŠµë‹ˆë‹¤."
  }
];

let contactLog = [];
try{
  const saved = JSON.parse(localStorage.getItem('oc_contact_log') || '[]');
  if(Array.isArray(saved) && saved.length){
    contactLog = saved;
  } else {
    contactLog = defaultContactLog.slice();
  }
}catch(e){
  contactLog = defaultContactLog.slice();
}

/* ================
   App State
   ================ */
const state = {
  wallet: Number(localStorage.getItem('oc_wallet') || 5000),
  purchases: JSON.parse(localStorage.getItem('oc_purchases') || '[]'),
  users: JSON.parse(localStorage.getItem('oc_users') || '{}'),
  logged: JSON.parse(localStorage.getItem('oc_logged') || '{}'),
  secretUnlocked: false,
  contactsLog: JSON.parse(localStorage.getItem('oc_contactsLog') || '[]'),
};

// ì—°ë½ ë¡œê·¸ê°€ ë¹„ì–´ ìˆìœ¼ë©´, ìƒ˜í”Œ ë¡œê·¸ ëª‡ ê°œ ì±„ì›Œë‘ê¸° (ì²˜ìŒ ì ‘ì†ìš©)
if (!state.contactsLog || state.contactsLog.length === 0) {
  state.contactsLog = [
    {
      id: 'LOG-BOOT-1',
      ts: Date.now() - 1000 * 60 * 60 * 5,
      from: "ì‚¬ë¬´ì†Œ ì§ì› Â· K-17",
      targetType: "staff",
      targetName: "ì…€ë ˆë¥´ë‹ˆì•„",
      direction: "in",
      content: "ì˜¤ëŠ˜ 23:00, Lower Docks ì ‘ì„  ì¤€ë¹„ ì™„ë£Œ. â€” ê¸°ì¡´ ê³„íšëŒ€ë¡œ ì§„í–‰í•©ë‹ˆë‹¤."
    },
    {
      id: 'LOG-BOOT-2',
      ts: Date.now() - 1000 * 60 * 30,
      from: "ìµëª… ì˜ë¢°ì¸",
      targetType: "client",
      targetName: "ì…€ë ˆë¥´ë‹ˆì•„",
      direction: "in",
      content: "\"ë³´ì•ˆêµ­ì´ ì œ ë’¤ë¥¼ ë°Ÿê³  ìˆì–´ìš”. ê¸°ë¡ì— ì œ ì´ë¦„ì€ ë‚¨ê¸°ì§€ ë§ì•„ì£¼ì„¸ìš”.\""
    }
  ];
  localStorage.setItem('oc_contactsLog', JSON.stringify(state.contactsLog));
}

let jobStatusFilter = 'all';   // ğŸ”¹ ì˜ë¢° ìƒíƒœ í•„í„°

/* ================
   Helpers & Rendering
   ================ */
function $(sel){ return document.querySelector(sel) }
function $all(sel){ return Array.from(document.querySelectorAll(sel)) }

function renderSummary(){
  $('#completed-count').textContent = jobs.filter(j=>j.status==='completed').length;
  $('#open-count').textContent = jobs.filter(j=>j.status==='open').length;
  $('#jobs-count').textContent = jobs.length;
  $('#wallet').textContent = state.wallet + ' creds';
  $('#wallet-count').textContent = state.wallet;
  $('#who').textContent = Object.keys(state.logged).length ? Object.keys(state.logged).join(', ') : 'ì—†ìŒ';
  $('#secretState').textContent = state.logged[SECRET_OWNER] ? 'ì—´ë¦¼' : 'ì ê¹€';
  renderRecent();
  renderJobs();
  renderIntel();
  renderMap();
  renderMarket();
  renderPurchases();
  renderContactLog();
}

function renderContactLog(){
  const wrap = $('#contact-log');
  if (!wrap) return;

  if (!contactLog.length){
    wrap.innerHTML =
      '<div class="contact-log-empty">ì•„ì§ ê¸°ë¡ëœ ëŒ€í™”ê°€ ì—†ìŠµë‹ˆë‹¤.</div>';
    return;
  }

  wrap.innerHTML = '';
  contactLog.slice().reverse().forEach(log=>{
    const el = document.createElement('div');
    el.className = 'contact-log-entry';

    const kind =
      log.kind === 'staff'  ? 'STAFF'  :
      log.kind === 'client' ? 'CLIENT' :
      log.kind === 'enemy'  ? 'ENEMY'  :
                              'LOG';

    const safeBody = (log.body || '')
      .replace(/</g,'&lt;')
      .replace(/>/g,'&gt;');

    el.innerHTML = `
      <div class="contact-log-meta">
        <div>
          <span class="contact-log-from">${log.from}</span>
          <span class="contact-log-to"> â†’ ${log.to}</span>
          <span class="contact-log-kind">[${kind}]</span>
        </div>
        <div>${log.time || ''}</div>
      </div>
      <div class="contact-log-body">${safeBody}</div>
    `;
    wrap.appendChild(el);
  });
}

function addContactEntry(from, to, kind, body){
  const entry = {
    id: 'L-' + Date.now().toString(36),
    from,
    to,
    kind,
    body,
    time: new Date().toLocaleString()
  };
  contactLog.push(entry);
  try{
    localStorage.setItem('oc_contact_log', JSON.stringify(contactLog));
  }catch(e){}
  renderContactLog();
}

function renderRecent(){
  const list = $('#recent-list'); 
  list.innerHTML = '';
  jobs.slice(0,6).forEach(j=>{
    const el = document.createElement('div'); 
    el.className='job';
    el.innerHTML = `
      <div style="display:flex;justify-content:space-between">
        <div>
          <div style="font-weight:700">${j.title}</div>
          <div class="meta">${j.location} Â· ë³´ìƒ: ${j.reward} Â· ìƒíƒœ: ${j.status}</div>
        </div>
        <div style="font-size:12px;color:var(--muted)">${j.client}</div>
      </div>
      <p style="margin-top:8px;color:var(--muted)">${j.desc}</p>`;
    list.appendChild(el);
  });
}

function renderJobs(filter = ''){
  const list = $('#jobs-list');
  list.innerHTML = '';

  jobs
    .filter(j =>
      (j.title + j.tags.join(' ') + j.client + j.status + j.desc)
        .toLowerCase()
        .includes(filter.toLowerCase())
    )
    .filter(j => jobStatusFilter === 'all' ? true : j.status === jobStatusFilter)
    .forEach(j=>{
      const el = document.createElement('div');
      el.className = 'job';

      const openBtn = j.status === 'open'
        ? `<button class="btn micro" data-accept="${j.id}">ìˆ˜ë½</button>`
        : '';

        const statusLabel = j.status === 'open'
        ? 'open'
        : (j.status === 'accepted' ? 'progress' : 'completed');

      const statusColor =
        j.status === 'open'      ? 'var(--neon-emerald)' :
        j.status === 'accepted'  ? '#ffc24c' :
                                   'var(--neon-pink)';

      el.innerHTML = `
        <div style="display:flex;justify-content:space-between;align-items:center">
          <div>
            <div style="font-weight:700">${j.title}</div>
            <div class="meta">
              í´ë¼ì´ì–¸íŠ¸: ${j.client}
              Â· ë³´ìƒ: ${j.reward} creds
              Â· ìƒíƒœ:
              <span style="color:${statusColor};font-weight:600;">
                ${statusLabel}
              </span>
            </div>
          </div>

          <div style="display:flex;flex-direction:column;gap:6px">
            ${openBtn}
            <button class="btn secondary micro" data-view="${j.id}">ë³´ê¸°</button>
          </div>
        </div>
      `;

      list.appendChild(el);
    });

  // ìˆ˜ë½ ë²„íŠ¼ â†’ accepted + ì•”í˜¸í™” í˜ì´ë¡œë“œ ìƒì„±
  $all('button[data-accept]').forEach(b => b.onclick = async (e)=>{
    const id = e.currentTarget.dataset.accept;
    const pw = prompt('ì•”í˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš” (ìˆ˜ì‹ ìì™€ ê³µìœ )');
    if(!pw) return;
    const enc = await encryptAES('Accept:' + id, pw);
    $('#payload').value = enc;

    const job = jobs.find(x => x.id === id);
    if (job) job.status = 'accepted';

    popup('ì˜ë¢°ê°€ ì§„í–‰ì¤‘ ìƒíƒœë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.\nContact íƒ­ì—ì„œ ì•”í˜¸í™” í˜ì´ë¡œë“œë¥¼ í™•ì¸í•˜ì„¸ìš”.');
    renderSummary();
    setView('contact');
  });

  // ë³´ê¸° ë²„íŠ¼ â†’ ì¤‘ì•™ íŒì—…
  $all('button[data-view]').forEach(b => b.onclick = (e)=>{
    const id = e.currentTarget.dataset.view;
    const j = jobs.find(x=>x.id===id);
    if(!j) return;
    openJobModal(j);
  });
}

function openBrokerModal(){
  const m = document.getElementById('brokerModal');
  if(m) m.style.display = 'block';
}

function closeBrokerModal(){
  const m = document.getElementById('brokerModal');
  if(m) m.style.display = 'none';
}


function renderIntel(){
  const list = $('#intel-list'); 
  if (!list) return;

  list.innerHTML = '';
  intel.forEach(i=>{
    const el = document.createElement('article'); 
    el.className = 'nd-intel-card';

    // ğŸ”¹ ë‚˜ì¤‘ì— í•˜ì´ë¼ì´íŠ¸ì— ì‚¬ìš©í•  íƒœê·¸/ID ì €ì¥
    el.dataset.id = i.id;
    el.dataset.tag = (i.tag || '').toLowerCase();

    el.innerHTML = `
      <div class="nd-intel-top">
        <div>
          <div class="nd-intel-title">${i.title}</div>
          <div class="nd-intel-meta">
            ${i.time} Â· ì‹ ë¢°ë„: ${i.trust}
          </div>
        </div>
        <div class="nd-intel-tag">${i.tag}</div>
      </div>
      <div class="nd-intel-body">${i.body}</div>
    `;
    list.appendChild(el);
  });
}

// ğŸ” íŠ¹ì • êµ¬ì—­ ì´ë¦„ì— ë§ëŠ” ì¸í…” ì¹´ë“œ í•˜ì´ë¼ì´íŠ¸
function highlightIntelForZone(zoneName) {
  const cards = document.querySelectorAll('#intel-list .nd-intel-card');
  if (!cards.length) return;

  // ì „ì²´ ì´ˆê¸°í™”
  cards.forEach(card => {
    card.classList.remove('intel-highlight', 'intel-dim');
  });

  if (!zoneName) return;

  const key = zoneName.toLowerCase();
  let anyHit = false;

  cards.forEach(card => {
    const title = (card.querySelector('.nd-intel-title')?.textContent || '').toLowerCase();
    const body  = (card.querySelector('.nd-intel-body')?.textContent  || '').toLowerCase();
    const tag   = (card.dataset.tag || '').toLowerCase();

    // ğŸ”¹ ê°„ë‹¨í•œ ë§¤ì¹­ ë£°:
    //  - ë³¸ë¬¸/ì œëª©ì— êµ¬ì—­ ì´ë¦„ì´ ë“¤ì–´ê°€ê±°ë‚˜
    //  - êµ¬ì—­ ì´ë¦„ì— ë§ëŠ” íƒœê·¸ê°€ ìˆì„ ë•Œ ë§¤ì¹­
    let hit = false;

    if (title.includes(key) || body.includes(key)) {
      hit = true;
    } else {
      // ì•½ê°„ì˜ ìˆ˜ë™ ë§¤í•‘ (ë„¤ì˜¤ë¦¬ë² ë¥´ ì„¤ì • ë°˜ì˜)
      if (zoneName === 'Old Subway' && tag === 'network') hit = true;
      if (zoneName === 'Corporate Spire' && (tag === 'corp' || tag === 'NSC')) hit = true;
      if (zoneName === 'Ghost Alley' && (tag === 'NMC' || tag === 'gang')) hit = true;
      if (zoneName === 'Lower Docks' && (tag === 'NMC' || tag === 'gang')) hit = true;
    }

    if (hit) {
      card.classList.add('intel-highlight');
      anyHit = true;
    } else {
      card.classList.add('intel-dim');
    }
  });

  // ë§¤ì¹­ë˜ëŠ” ê²Œ í•˜ë‚˜ë„ ì—†ìœ¼ë©´ ê·¸ëƒ¥ ì›ìƒë³µêµ¬ (ë„ˆë¬´ í—ˆì „í•˜ë©´)
  if (!anyHit) {
    cards.forEach(card => {
      card.classList.remove('intel-highlight', 'intel-dim');
    });
  }
}

function renderMap(){
  const grid = $('#map-grid'); 
  if (!grid) return;

  const nameEl  = $('#map-detail-name');
  const levelEl = $('#map-detail-level');
  const descEl  = $('#map-detail-desc');
  const keyEl   = $('#map-detail-key');
  
  const holoName = $('#map-holo-name');
  const holoMeta = $('#map-holo-meta');
  const holoCells = $all('.nd-map-holo-cell');

  function setDetail(z){
    if (!z || !nameEl) return;
    nameEl.textContent  = z.name;
    levelEl.textContent = `ìœ„í—˜ë„ ë ˆë²¨ ${z.level} Â· ìƒíƒœ: ${z.hazard}`;
    descEl.textContent  = z.desc;
    if (keyEl) {
      keyEl.innerHTML = `í•µì‹¬ í¬ì¸íŠ¸: ${z.key || 'N/A'}`;
    }

    // ğŸ”¹ í™€ë¡œê·¸ë¨ íŒ¨ë„ ì—…ë°ì´íŠ¸
    if (holoName) holoName.textContent = z.name;
    if (holoMeta) holoMeta.textContent = `LV.${z.level} Â· status: ${z.hazard}`;

    if (holoCells && holoCells.length){
      const idx = z.level % holoCells.length;   // ë ˆë²¨ì— ë”°ë¼ ì¹¸ í•˜ë‚˜ ë°œê´‘
      holoCells.forEach((c,i)=>{
        c.classList.toggle('active', i === idx);
      });
    }

    // ğŸ”¹ ì„ íƒ ì‹œ HOLO íŒ¨ë„ í„ìŠ¤ íš¨ê³¼
    const holoBox = $('#map-holo');
    if (holoBox) {
      holoBox.classList.remove('pulse');
      // reflowë¡œ ì• ë‹ˆë©”ì´ì…˜ ì¬ì‹œì‘
      void holoBox.offsetWidth;
      holoBox.classList.add('pulse');
    }
    highlightIntelForZone(z.name);
  }



  grid.innerHTML = '';
  mapZones.forEach(z=>{
    const el = document.createElement('div'); 
    el.className = 'zone';
    el.innerHTML = `
      <div style="font-weight:700">${z.name}</div>
      <div class="meta">ë ˆë²¨: ${z.level} Â· ì£¼ì˜: ${z.hazard}</div>
      <div class="key">${z.desc}</div>
      <div class="tag">${z.key || ''}</div>`;
    el.onmouseenter = (ev)=>showTip(
      ev.currentTarget,
      `<strong>${z.name}</strong><br/>${z.desc}<br/><span style='color:var(--muted)'>í•µì‹¬: ${z.key || 'N/A'}</span>`
    );
    el.onmouseleave = hideTip;
    el.onclick = ()=> setDetail(z);
    grid.appendChild(el);
  });

  // ê¸°ë³¸ ì„ íƒê°’: ì²« ë²ˆì§¸ êµ¬ì—­
  if (mapZones.length) setDetail(mapZones[0]);
}

/* âœ… Market ë Œë”ë§: ì‹¤ì œë¡œ DOMì— ì¶”ê°€í•˜ë„ë¡ ìˆ˜ì • */
function renderMarket() {
  const container = document.querySelector("#Market .item-list");
  if (!container) return;

  container.innerHTML = "";

  items.forEach(item => {
    const el = document.createElement("div");
    el.className = "content-box";

    el.innerHTML = `
      <div class="box-header">
        <div>
          <div class="item-name">${item.name}</div>
          <div class="item-id">${item.id}</div>
        </div>
        <div class="${item.stock <= 2 ? 'low-stock' : ''}">
          ì¬ê³ : ${item.stock}
        </div>
      </div>

      <p class="item-desc">${item.desc}</p>

      <div class="box-footer">
        <span>â‚¦ ${item.price.toLocaleString()}</span>
        <button
          type="button"
          class="buy-btn"
          onclick="buyItem('${item.id}')"
          ${item.stock === 0 ? 'disabled' : ''}
        >
          êµ¬ë§¤
        </button>
      </div>
    `;

    container.appendChild(el);
  });
}

// Contact: ì…€ë ˆë¥´ë‹ˆì•„ í†µì‹  í—ˆë¸Œ ì…ë ¥
const contactSendBtn = $('#contact-send');
if (contactSendBtn) {
  contactSendBtn.addEventListener('click', () => {
    const textarea = $('#contact-input');
    const targetSel = $('#contact-recipient');
    if (!textarea) return;

    const text = textarea.value.trim();
    if (!text) {
      popup('ë‚¨ê¸¸ ë‚´ìš©ì„ ë¨¼ì € ì…ë ¥í•˜ì„¸ìš”.');
      return;
    }

    const to = targetSel ? targetSel.value : 'ê¸°ë¡';
    addContactEntry('ì…€ë ˆë¥´ë‹ˆì•„', to, 'outgoing', text);
    textarea.value = '';
  });
}

const contactClearBtn = $('#contact-clear');
if (contactClearBtn) {
  contactClearBtn.addEventListener('click', () => {
    const textarea = $('#contact-input');
    if (textarea) textarea.value = '';
  });
}


/* purchases: ì•ˆì „ ê°€ë“œ ì¶”ê°€ */
function renderPurchases(){
  const el = $('#purchases');
  if (!el) return;   // ìš”ì†Œ ì—†ìœ¼ë©´ ê·¸ëƒ¥ ìŠ¤í‚µ
  if(state.purchases.length===0) el.textContent='ì—†ìŒ';
  else el.innerHTML = state.purchases
    .slice(-6)
    .map(p=>`<div>${new Date(p.time).toLocaleString()} â€” ${p.name}</div>`)
    .join('');
}

/* tooltip logic */
let tipEl;
function showTip(target, html){
  hideTip();
  tipEl = document.createElement('div'); 
  tipEl.className='tooltip'; 
  tipEl.innerHTML = html;
  document.body.appendChild(tipEl);
  const r = target.getBoundingClientRect();
  tipEl.style.left = (r.left + window.scrollX) + 'px';
  tipEl.style.top = (r.top + window.scrollY - tipEl.offsetHeight - 10) + 'px';
}
function hideTip(){ 
  if(tipEl){ 
    tipEl.remove(); 
    tipEl=null; 
  } 
}

/* ================
   Actions
   ================ */
   function showRouteOverlay(targetId, callback) {
  const overlay = $('#routeOverlay');
  const txt = $('#routeOverlayText');
  if (!overlay || !txt) {
    // ì˜¤ë²„ë ˆì´ê°€ ì—†ìœ¼ë©´ ê·¸ëƒ¥ ë°”ë¡œ ì „í™˜
    callback();
    return;
  }

  const label = targetId.toUpperCase();
  txt.textContent = `ROUTING : ${label}`;
  txt.setAttribute('data-text', `ROUTING : ${label}`);

  overlay.classList.add('visible');

  setTimeout(() => {
    callback();
    overlay.classList.remove('visible');
  }, 550);   // ì˜¤ë²„ë ˆì´ ë³´ì—¬ì£¼ëŠ” ì‹œê°„
}

function setView(id){
  showRouteOverlay(id, () => {
    ['#home','#jobs','#intel','#map','#contact','#Market'].forEach(s => {
      const el = document.querySelector(s);
      if(!el) return;
      el.style.display = (s === '#' + id) ? '' : 'none';
    });

    // nav í•˜ì´ë¼ì´íŠ¸
    $all('nav .nav-btn').forEach(b => {
      b.style.opacity = b.dataset.target === id ? '1' : '0.8';
    });
  });
}


$all('nav .nav-btn').forEach(b=>{
  b.onclick = ()=>setView(b.dataset.target);
});

$('#postJob').onclick = ()=>{
  const title = prompt('ì˜ë¢° ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”');
  const desc = prompt('ì˜ë¢° ìƒì„¸ë¥¼ ì…ë ¥í•˜ì„¸ìš” (ì¼ë°˜ì¸ì²˜ëŸ¼ ì‘ì„±)') || '';
  const reward = Number(prompt('ë³´ìƒ í¬ë ˆë”§ (ìˆ«ì)') || 1000);
  if(!title) return popup('ì œëª© í•„ìš”');
  const id = 'U-' + Math.floor(Math.random()*90000 + 10000);
  jobs.unshift({ id, title, client:'ì›¹ ì˜ë¢°ì', reward, tags:['user'], location:'ìœ ì € ì§€ì •', difficulty:'Var', desc, status:'open' });
  popup('ì˜ë¢°ê°€ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤. Jobs íƒ­ì—ì„œ í™•ì¸í•˜ì„¸ìš”.');
  renderSummary();
  setView('jobs');
};

$('#refreshJobs').onclick = ()=>renderJobs($('#job-search').value);
$('#job-search').addEventListener('input', ()=>renderJobs($('#job-search').value));

// ìƒíƒœ í•„í„° ë²„íŠ¼ë“¤
const jobFilterButtons = $all('.job-filter');
jobFilterButtons.forEach(btn => {
  btn.addEventListener('click', () => {
    jobStatusFilter = btn.dataset.status || 'all';

    jobFilterButtons.forEach(b => b.classList.toggle('active', b === btn));
    renderJobs($('#job-search').value);
  });
});

// ì²˜ìŒ ë¡œë“œì‹œ "ì „ì²´" í™œì„±í™”
const defaultFilterBtn = document.querySelector('.job-filter[data-status="all"]');
if (defaultFilterBtn) defaultFilterBtn.classList.add('active');


function openJobModal(job) {
  const modal = document.getElementById("jobModal");
  const content = document.getElementById("jobModalContent");

  content.innerHTML = `
    <div style="font-size:13px;color:var(--muted);margin-bottom:6px;">
      [${job.id}] Â· ${job.location} Â· ë‚œì´ë„: ${job.difficulty}
    </div>
    <h2 class="glitch" data-text="${job.title}" style="margin:0 0 10px 0;">
      ${job.title}
    </h2>
    <p style="font-size:13px;color:var(--muted);margin:0 0 12px 0;">
      ì˜ë¢°ì: ${job.client}
    </p>
    <p style="font-size:14px;margin:0 0 12px 0;">
      ${job.desc}
    </p>
    <div style="font-size:13px;">
      ë³´ìƒ: <span style="color:var(--neon-emerald);font-weight:700;">${job.reward} creds</span>
    </div>
    <div style="margin-top:14px;font-size:11px;color:var(--muted);text-align:right;">
      Click anywhere to close
    </div>
  `;

  modal.style.display = "block";

  // ë°°ê²½ í´ë¦­ìœ¼ë¡œ ë‹«ê¸°
  modal.onclick = (e) => {
    if (e.target === modal) {
      closeJobModal();
    }
  };
}


function closeJobModal() {
  document.getElementById("jobModal").style.display = "none";
}

/* ================
   Buy item
   ================ */
function buyItem(id){
  const it = items.find(x=>x.id===id);
  if(!it) return;
  if(state.wallet < it.price) return popup('ì”ì•¡ ë¶€ì¡±');
  it.stock -= 1;
  state.wallet -= it.price;
  state.purchases.push({ id: it.id, name: it.name, time: Date.now() });
  localStorage.setItem('oc_purchases', JSON.stringify(state.purchases));
  localStorage.setItem('oc_wallet', String(state.wallet));
  popup(`${it.name} êµ¬ë§¤ ì™„ë£Œ`);
  renderSummary();
}

/* ================
   Encryption (AES-GCM w/ PBKDF2)
   ================ */
async function deriveKey(password, saltBytes){
  const enc = new TextEncoder();
  const baseKey = await crypto.subtle.importKey('raw', enc.encode(password), 'PBKDF2', false, ['deriveKey']);
  const key = await crypto.subtle.deriveKey(
    { name:'PBKDF2', salt: saltBytes, iterations: 200000, hash:'SHA-256' },
    baseKey,
    { name:'AES-GCM', length: 256 },
    false,
    ['encrypt','decrypt']
  );
  return key;
}

async function encryptAES(plaintext, password){
  const iv = crypto.getRandomValues(new Uint8Array(12));
  const salt = crypto.getRandomValues(new Uint8Array(16));
  const key = await deriveKey(password, salt);
  const enc = new TextEncoder();
  const cipher = await crypto.subtle.encrypt({ name:'AES-GCM', iv }, key, enc.encode(plaintext));
  return btoa(JSON.stringify({ salt:Array.from(salt), iv:Array.from(iv), data:Array.from(new Uint8Array(cipher)) }));
}

async function decryptAES(packB64, password){
  try{
    const pack = JSON.parse(atob(packB64));
    const salt = new Uint8Array(pack.salt);
    const iv = new Uint8Array(pack.iv);
    const data = new Uint8Array(pack.data);
    const key = await deriveKey(password, salt);
    const plain = await crypto.subtle.decrypt({ name:'AES-GCM', iv }, key, data);
    return new TextDecoder().decode(plain);
  }catch(e){
    return null;
  }
}

$('#encryptBtn').onclick = async ()=>{
  const text = $('#payload').value || 'ping';
  const pw = prompt('ì•”í˜¸ ì…ë ¥ (ìˆ˜ì‹ ìì™€ ê³µìœ í•˜ì„¸ìš”)');
  if(!pw) return;
  const enc = await encryptAES(text, pw);
  try{ 
    await navigator.clipboard.writeText(enc); 
    popup('ì•”í˜¸í™”ëœ í˜ì´ë¡œë“œê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.'); 
  }catch(e){ 
    popup('ì•”í˜¸í™” ê²°ê³¼:\n' + enc);
  }
};

$('#decryptBtn').onclick = async ()=>{
  const pack = prompt('ë³µí˜¸í™”í•  í˜ì´ë¡œë“œ ë¶™ì—¬ë„£ê¸° (base64) â€” ì·¨ì†Œí•˜ë©´ í˜„ì¬ í˜ì´ë¡œë“œ ì‚¬ìš©');
  const p = pack || $('#payload').value;
  if(!p) return;
  const pw = prompt('ì•”í˜¸ ì…ë ¥');
  if(!pw) return;
  const dec = await decryptAES(p, pw);
  if(dec === null) popup('ë³µí˜¸í™” ì‹¤íŒ¨ â€” ë¹„ë°€ë²ˆí˜¸/í˜ì´ë¡œë“œ í™•ì¸');
  else{ 
    $('#payload').value = dec; 
    popup('ë³µí˜¸í™” ì™„ë£Œ â€” í˜ì´ë¡œë“œì— ë‚´ìš©ì´ ì±„ì›Œì¡ŒìŠµë‹ˆë‹¤.');
  }
};

$('#clearPayload').onclick = ()=>$('#payload').value='';

/* ================
   Broker register/login
   ================ */
async function hashPassword(password, saltBytes){
  const enc = new TextEncoder();
  const baseKey = await crypto.subtle.importKey('raw', enc.encode(password), 'PBKDF2', false, ['deriveBits']);
  const derived = await crypto.subtle.deriveBits(
    { name:'PBKDF2', salt: saltBytes, iterations: 200000, hash:'SHA-256' },
    baseKey,
    256
  );
  return btoa(String.fromCharCode(...new Uint8Array(derived)));
}

async function registerBroker(name, password){
  if(!name || !password) return false;
  if(state.users[name]) return false;
  const salt = crypto.getRandomValues(new Uint8Array(16));
  const h = await hashPassword(password, salt);
  state.users[name] = { salt:Array.from(salt), hash:h, created: Date.now() };
  localStorage.setItem('oc_users', JSON.stringify(state.users));
  return true;
}

async function verifyBroker(name, password){
  const rec = state.users[name];
  if(!rec) return false;
  const salt = new Uint8Array(rec.salt);
  const h = await hashPassword(password, salt);
  return h === rec.hash;
}

$('#loginBtn').onclick = async ()=>{
  const modeRaw = prompt('ë¡œê·¸ì¸ ë˜ëŠ” ë“±ë¡ (type: login / register)');
  if(!modeRaw) return;
  const mode = modeRaw.trim();

  if(mode === 'register'){
    const uRaw = prompt('ë“±ë¡í•  ë¸Œë¡œì»¤ ID (ì˜ˆ: raven)');
    if(!uRaw) return popup('ID í•„ìš”');
    const u = uRaw.trim();

    const pRaw = prompt('íŒ¨ìŠ¤ì›Œë“œ');
    if(!pRaw) return popup('PW í•„ìš”');
    const p = pRaw.trim();

    const ok = await registerBroker(u,p);
    popup(ok? 'ë“±ë¡ ì„±ê³µ (ë¡œì»¬ ì €ì¥)' : 'ë“±ë¡ ì‹¤íŒ¨ (ì´ë¯¸ ì¡´ì¬)');
    renderSummary();
    return;
  }

  if(mode === 'login'){
    const uRaw = prompt('ë¸Œë¡œì»¤ ID');
    if(!uRaw) return;
    const u = uRaw.trim();

    const pRaw = prompt('íŒ¨ìŠ¤ì›Œë“œ');
    if(!pRaw) return;
    const p = pRaw.trim();

    const ok = await verifyBroker(u,p);
    if(ok){
      const token = await encryptAES(JSON.stringify({ user:u, ts:Date.now() }), p);
      state.logged[u] = token;
      localStorage.setItem('oc_logged', JSON.stringify(state.logged));
      uiPopup('<h3 class="neon-text">ë¡œê·¸ì¸ ì„±ê³µ</h3>');

      if(u === SECRET_OWNER){
        state.secretUnlocked = true;
        $('#secretPopup').style.display = '';
      }

      renderSummary();
    } else {
      popup('ë¡œê·¸ì¸ ì‹¤íŒ¨ â€” ID ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ë¥¼ í™•ì¸í•˜ì„¸ìš”.');
    }
    return;
  }

  popup('ì…ë ¥ ì˜¤ë¥˜: login ë˜ëŠ” register ì¤‘ í•˜ë‚˜ë¥¼ ì…ë ¥í•˜ì„¸ìš”.');
};

$('#clipSecret').onclick = ()=>{
  navigator.clipboard?.writeText(JSON.stringify({ vault:'protocol-keys', time:Date.now() }))
    .then(()=>popup('ë°ëª¨ ë¹„ë°€ì´ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.'));
};

/* Secret popup reveal on load */
if(state.logged[SECRET_OWNER]) {
  state.secretUnlocked = true;
  $('#secretPopup').style.display = '';
}

/* Easter egg button */
document.getElementById('eggBtn').addEventListener('click', () => {
  popup('Easter Egg: ë‚´ë¶€ ë ˆì´ì–´ ì ‘ê·¼ ë¶ˆê°€ â€” (ë°ëª¨)');
  const r = document.getElementById('glitchRange');
  r.value = Math.min(6, Number(r.value) + 1);
  applyGlitchStrength(r.value);
});

$('#showDev').onclick = ()=>{
  popup('Dev Easter: ì €ì¥ëœ ë¸Œë¡œì»¤ ëª©ë¡ê³¼ ë¡œê·¸ì¸ í† í°ì„ ì½˜ì†”ë¡œ ì¶œë ¥í•©ë‹ˆë‹¤.');
  console.log('users', state.users);
  console.log('logged', state.logged);
  popup('ì½˜ì†”ì„ í™•ì¸í•˜ì„¸ìš”.');
};

/* Sound (low hum) */
let audioCtx, osc, gain;
let playing = false;

$('#soundToggle').onclick = async () => {
  audioCtx = audioCtx || new (window.AudioContext || window.webkitAudioContext)();
  if (audioCtx.state === "suspended") await audioCtx.resume();

  if (!playing) {
    osc = audioCtx.createOscillator();
    gain = audioCtx.createGain();
    osc.type = "sine";
    osc.frequency.setValueAtTime(38, audioCtx.currentTime);
    gain.gain.setValueAtTime(0.015, audioCtx.currentTime);

    osc.connect(gain);
    gain.connect(audioCtx.destination);
    osc.start();
    playing = true;
    $('#soundToggle').textContent = 'ì‚¬ìš´ë“œ (ON)';
  } else {
    osc.stop();
    playing = false;
    $('#soundToggle').textContent = 'ì‚¬ìš´ë“œ';
  }
};

/* Glitch strength control */
function applyGlitchStrength(v){
  const px = (v * 1.2).toFixed(2) + 'px';
  document.documentElement.style.setProperty('--glitch-x', px);
  document.documentElement.style.setProperty('--glitch-y', (v>2? -1*v/2 : -1) + 'px');
  const speed = 1200 + (6 - v) * 600;
  document.documentElement.style.setProperty('--glitch-speed', speed + 'ms');
}
$('#glitchRange').addEventListener('input', (e)=>{ applyGlitchStrength(e.target.value) });

/* DARK TRACE ë²„íŠ¼ (ì•ˆì „ ê°€ë“œ) */
const darkBtn = document.querySelector('#darkTraceBtn');
if (darkBtn) {
  darkBtn.onclick = () => {
    popup("âš  DARKÂ·TRACE SYSTEM\n\ní˜„ì¬ ê¸°ë¡ì€ ì•”í˜¸í™”ë˜ì–´ ìˆì–´ ì ‘ê·¼ ê¶Œí•œì´ í•„ìš”í•©ë‹ˆë‹¤.");
  };
}

// =======================
// 5ì´ˆ ë¡œë”© í›„ ë©”ì¸ í™”ë©´ í‘œì‹œ
// =======================
window.addEventListener('load', () => {
  const loader = document.getElementById('loading-screen');
  if (!loader) return;

  // ğŸ”’ ë¡œë”© ì¤‘ì—ëŠ” ìŠ¤í¬ë¡¤ ì ê·¸ê¸°
  document.documentElement.style.overflow = 'hidden';
  document.body.style.overflow = 'hidden';

  setTimeout(() => {
    loader.style.opacity = '0';
    setTimeout(() => {
      loader.remove();

      // ğŸ”“ ë¡œë”© ëë‚˜ë©´ ë‹¤ì‹œ ìŠ¤í¬ë¡¤ í’€ê¸°
      document.documentElement.style.overflow = '';
      document.body.style.overflow = '';
    }, 400);
  }, 2500); // 2.5ì´ˆ ë¡œë”©
});


// =======================
// World Ticker (ìƒë‹¨ ìƒíƒœ ë¡œê·¸ íšŒì „)
// =======================
const worldLogs = [
  "PACKET LOSS: 72% Â· ê°ì‹œë§ ë¶ˆì•ˆì •",
  "LOWER DOCKS: ê°±ë‹¨ ì¶©ëŒ ë³´ê³ ë¨",
  "BLACK MARKET: ì•”ì‹œì¥ ê±°ë˜ëŸ‰ ê¸‰ì¦",
  "CORP SPIRE: ë‚´ë¶€ ìŠ¤íŒŒì´ íƒì§€ ë¡œê·¸ ìƒì„±",
  "OLD SUBWAY: ë¹„ì¸ê°€ ë£¨íŠ¸ ê¶Œí•œ ì‹œë„ ì°¨ë‹¨",
  "lobby: ì˜ë¢°ì¸ ì…ì¥ì¤‘ì…ë‹ˆë‹¤",
  "N.S.C.: ì…€â–ˆë¥´â–ˆâ–ˆ, ì´ê²Œ ë„ˆâ–ˆì˜ ì‚¬â–ˆâ–ˆì¸ê°€?"
];

let worldLogIndex = 0;

function rotateWorldLog() {
  const el = document.getElementById("worldTickerText");
  if (!el) return;

  el.textContent = worldLogs[worldLogIndex];
  worldLogIndex = (worldLogIndex + 1) % worldLogs.length;
}


/* initialize */
applyGlitchStrength($('#glitchRange').value);
renderSummary();
rotateWorldLog();
setInterval(rotateWorldLog, 12000);   // 12ì´ˆë§ˆë‹¤ ë„ì‹œ ìƒíƒœ ê°±ì‹ 

// ì‚¬ì´ë“œ ì•Œë¦¼: ì•½ê°„ ë”œë ˆì´ í›„ ì£¼ê¸°ì ìœ¼ë¡œ í‘œì‹œ
setTimeout(() => {
  spawnSideAlert();
  setInterval(spawnSideAlert, 9000);  // 12ì´ˆë§ˆë‹¤ í•˜ë‚˜ì”©
}, 5000);

/* switch view on load */
setView('home');

/* expose for debugging (optional) */
window._oc = { jobs, intel, mapZones, items, state, encryptAES, decryptAES };

/* =========================
   Side floating alert logic
   ========================= */
   const sideAlertPool = [
   {
    title: "NSC-KID // CELERENIA",
    body: "ë³´ì•ˆêµ­ ë¶„ë¥˜: NSC-KID-R0\nìƒíƒœ: ìµœìš°ì„  ê°ì‹œ ë° êµì „ íšŒí”¼ ê¶Œê³ .\në¹„ê³ : â€˜ì˜µì‹œë””ì–¸ ë””ë ‰í‹°ë¸Œâ€™ì™€ ì§ì ‘ ì—°ê´€.",
    tag: "HIGH PRIORITY"
  },
  {
    title: "SYSÂ·ALERT",
    body: "ì˜ˆìƒì¹˜ ëª»í•œ íŒ¨í‚· êµ°ì§‘ ê°ì§€.\ní•˜ì¸µ ë…¸ë“œì—ì„œ ë¹„ì¸ê°€ íŠ¸ë˜í”½ ë°œìƒ.",
    tag: "MONITORING"
  },
  {
    title: "OFFICE // DIRECTOR",
    body: "ì…€ë ˆë¥´ë‹ˆì•„: \"ì˜ë¢° ë¬¸êµ¬ì— ê°ì • ì„ì§€ ë§ˆ. ê¸°ë¡ì€ í•­ìƒ ì°¨ê°‘ê²Œ.\"",
    tag: "INTERNAL NOTE"
  },
  {
    title: "SUPPORT // NSC-KID",
    body: "ë¦¬ë ˆì´: \"â€¦ì´ ì±„ë„ êµ¬ì¡°, ì˜ˆì „ì— ë‚´ê°€ ì§€ì› ë˜ ë¡œê·¸ë‘ ë˜‘ê°™ì•„ ë³´ì—¬.\"",
    tag: "FIELD MEMO"
  },
  {
    title: "GUARD // BODYGUARD",
    body: "ì•„ì´ê¸°ìŠ¤: \"ë¬¸ ì•ì—ì„œ ê¸°ë‹¤ë¦¬ëŠ” ê²ƒë„ ì˜ë¢°ì•¼. ì˜¤ëŠ˜ì€ ì¡°ìš©í•˜ê¸¸ ë°”ë€ë‹¤.\"",
    tag: "STATIONED"
  },
  {
    title: "SYSÂ·ALERT",
    body: "ê°ì‹œë§: \"ë¹„ì¸ê°€ íŒ¨í‚·ì´ ë„¤ì˜¤ë¦¬ë² ë¥´ í•˜ì¸µìœ¼ë¡œ ëˆ„ìˆ˜ ì¤‘.\"",
    tag: "WARNING"
  },
  {
    title: "LOBBY CHAT",
    body: "ë¡œë¹„ ì§ì›: \"ì»¤í”¼ ë¨¸ì‹  ë˜ ê³ ì¥ë‚¬ì–´ìš”. ì´ë²ˆì—” ëˆ„ê°€ í•´í‚¹í•œ ê±°ì˜ˆìš”?\"",
    tag: "OFFICE LIFE"
  },
  {
    title: "RAVEN // NOTE",
    body: "\"ì˜ë¢°ìì—ê²Œ ë„ˆë¬´ ì • ë¶™ì´ì§€ ë§ˆ. ì´ ë„ì‹œëŠ” ê·¸ëŸ° ê±¸ ì˜¤ë˜ ë†”ë‘ì§€ ì•Šìœ¼ë‹ˆê¹Œ.\"",
    tag: "BROKER MEMO"
  },
  {
    title: "INTERNAL LOG",
    body: "ê¸°ë¡: \"ë³´ì•ˆêµ­ NSC ì¶œì‹  ì†Œë…„, ì˜¬ë“œ ì±„ë„ì—ì„œ íšŒìˆ˜ë¨. ìƒíƒœ: ë¶ˆì•ˆì • but ìœ ìš©.\"",
    tag: "CLASSIFIED"
  },
  {
    title: "OPSÂ·ROOM",
    body: "ì…€ë ˆë¥´ë‹ˆì•„: \"ì˜¤ëŠ˜ë„ ìš°ë¦¬ ì‚¬ë¬´ì†Œê°€ ë²•ë³´ë‹¤ ë¨¼ì € ë„ì°©í•œë‹¤.\"",
    tag: "MISSION"
  },
  {
    tittle: "STAFF CHAT",
    body: "ë¡œë¹„ ì§ì›: \"ì‚¬ì¥ë‹˜.. ê¸°ë¬¼ íŒŒì†ì€ ì¢€ ì°¸ì•„ì£¼ì„¸ìš”..\"",
    tag: "OFFICE LIFE"
  },
  {
    tittle: "GUARD // BODYGUARD",
    body: "ì•„ì´ê¸°ìŠ¤: \"ë§ˆìŠ¤í„°. ë¶„ëª… ì•ˆë‹¤ì¹œë‹¤ê³  í–ˆìœ¼ë©´ì„œ...\"",
    tag: "STATIONED"
  },
  {
    title: "NSCÂ·OVERRIDE",
    body: "NSC ìƒì¸µ ì½˜ì†”ì—ì„œ í•˜ì¸µ ê°ì‹œ ê·œì¹™ì„ ì¬ì •ì˜í–ˆìŠµë‹ˆë‹¤.\nê¸°ì¡´ ìš°íšŒ ë£¨íŠ¸ ì¼ë¶€ê°€ ë” ì´ìƒ ì•ˆì „í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.",
    tag: "NSC ROUTE"
  },
  {
    title: "NMC NIGHT ROUTE",
    body: "NMC ì•¼ê°„ ì •ë¹„ë°˜ì´ Ghost Alley â†’ Lower Docks êµ¬ê°„ì„ ë°˜ë³µ ìˆœíšŒ ì¤‘.\nê³µì‹ ì •ë¹„ ì¼ì •ê³¼ ì¼ì¹˜í•˜ì§€ ì•ŠëŠ” ë£¨íŠ¸ì…ë‹ˆë‹¤.",
    tag: "NMC PATROL"
  },
  {
    title: "WANTED // RAVEN",
    body: "ë„¤íŠ¸ì›Œí¬ ì¹¨íˆ¬ ì‹œë„ ë¡œê·¸ 14ê±´.\nìµœê·¼ í™œë™ êµ¬ì—­: HoloÂ·District / Lower Docks.",
    tag: "THREAT LV. B+"
  },
  {
    title: "TRACE WARNING",
    body: "ì—­ì¶”ì  ì‹œë„ ê°€ëŠ¥ì„± ê°ì§€.\nê°™ì€ ì±„ë„ì—ì„œ ì˜¤ë˜ ë¨¸ë¬´ë¥´ì§€ ë§ˆì‹­ì‹œì˜¤.",
    tag: "RECOMMEND: HOP NODE"
  },
  {
    title: "OBSIDIANÂ·DIR PING",
    body: "ì˜µì‹œë””ì–¸ ë””ë ‰í‹°ë¸Œ ë‚´ë¶€ ì±„ë„ë¡œ ë¯¸í™•ì¸ íŒ¨í‚· ë„ì°©.\nìˆ˜ì‹ ì íƒœê·¸: \"ì…€ë ˆë¥´ë‹ˆì•„\" â€” ë°œì‹ ìëŠ” ë§ˆìŠ¤í‚¹ë¨.",
    tag: "INTERNAL"
  },
  {
    title: "BLACK MARKET PING",
    body: "ì‹ ê·œ ì¥ë¹„ ì…ê³ : GhostÂ·Router.\nì¼ì‹œì ìœ¼ë¡œ ê°€ê²© ë³€ë™ ê°ì§€.",
    tag: "MARKET FEED"
  },
  {
    title: "CCTV ROUTE UPDATE",
    body: "ìƒë‹¨ êµ¬ì—­ ì¹´ë©”ë¼ íšŒì „ ì£¼ê¸° ë³€ê²½.\nNSC ë¡œê·¸ ê¸°ì¤€, ê°™ì€ êµ¬ì—­ì´ ë‘ ë²ˆ ê²¹ì³ ì´¬ì˜ë˜ëŠ” êµ¬ê°„ ë°œê²¬.",
    tag: "SURVEILLANCE"
  },
  {
    title: "UNKNOWN SIGNAL",
    body: "ë™ë¶€ êµ¬ì—­ì—ì„œ ë°˜ë³µ ì‹ í˜¸ ìˆ˜ì‹ :\n\"â€¦ê±°ê¸° ëˆ„êµ¬ëƒâ€¦?\"\nNMC êµ¬í˜• ì¥ë¹„ì—ì„œ ì“°ë˜ í¬ë§·ê³¼ ìœ ì‚¬.",
    tag: "GLITCH FEED"
  },
  {
    title: "OLDÂ·CH FRAGMENT",
    body: "OLD CHANNELì—ì„œ ë³µì›ëœ ë¡œê·¸ ì¡°ê°:\n\"â€¦ë„ì‹œ ë°±ì—… ê¶Œí•œì„ ì…€ë ˆë¥´ë‹ˆì•„ì—ê²Œ ì´ì „â€¦\"\nì´í›„ ë°ì´í„°ëŠ” ì „ë¶€ íƒœì›Œì¡ŒìŠµë‹ˆë‹¤.",
    tag: "ARCHIVE"
  }
];

function spawnSideAlert() {
  // ë„ˆë¬´ íŒì—…ì´ ë§ì•„ì§€ì§€ ì•Šë„ë¡, ì´ë¯¸ ë–  ìˆëŠ” ê²Œ ìˆìœ¼ë©´ ê°€ë” ìŠ¤í‚µ
  if (document.querySelectorAll('.side-alert').length > 3) return;

  const msg = sideAlertPool[Math.floor(Math.random() * sideAlertPool.length)];
  const side = Math.random() < 0.5 ? 'left' : 'right';

  const el = document.createElement('div');
  el.className = `side-alert side-alert-${side} glitch-text`;

  // ì„¸ë¡œ ìœ„ì¹˜ë¥¼ ëœë¤ (ìƒë‹¨/í•˜ë‹¨ ë„ˆë¬´ í”¼í•´ì„œ 10~80vh)
  const topVH = 10 + Math.random() * 70;
  el.style.top = `${topVH}vh`;

  el.innerHTML = `
    <div class="side-alert-title">${msg.title}</div>
    <div class="side-alert-body">
      ${msg.body.replace(/\n/g, "<br>")}
    </div>
    <div class="side-alert-tag">${msg.tag}</div>
  `;

  document.body.appendChild(el);

  // ì• ë‹ˆë©”ì´ì…˜ ëë‚œ í›„ ìë™ ì œê±°
  setTimeout(() => {
    el.remove();
  }, 4300);
}


function spawnSideAlert() {
  // ë„ˆë¬´ íŒì—…ì´ ë§ì•„ì§€ì§€ ì•Šë„ë¡, ì´ë¯¸ ë–  ìˆëŠ” ê²Œ ìˆìœ¼ë©´ ê°€ë” ìŠ¤í‚µ
  if (document.querySelectorAll('.side-alert').length > 3) return;

  const msg = sideAlertPool[Math.floor(Math.random() * sideAlertPool.length)];
  const side = Math.random() < 0.5 ? 'left' : 'right';

  const el = document.createElement('div');
  el.className = `side-alert side-alert-${side} glitch-text`;

  // ì„¸ë¡œ ìœ„ì¹˜ë¥¼ ëœë¤ (ìƒë‹¨/í•˜ë‹¨ ë„ˆë¬´ í”¼í•´ì„œ 10~80vh)
  const topVH = 10 + Math.random() * 70;
  el.style.top = `${topVH}vh`;

  el.innerHTML = `
    <div class="side-alert-title">${msg.title}</div>
    <div class="side-alert-body">
      ${msg.body.replace(/\n/g, "<br>")}
    </div>
    <div class="side-alert-tag">${msg.tag}</div>
  `;

  document.body.appendChild(el);

  // ì• ë‹ˆë©”ì´ì…˜ ëë‚œ í›„ ìë™ ì œê±°
  setTimeout(() => {
    el.remove();
  }, 4300);
}


/* small popup helpers */
function popup(msg){
  uiPopup(`
    <div class="small" style="white-space:pre-line">
      ${msg}
    </div>
    <button class="btn secondary micro"
            style="margin-top:12px;width:100%"
            onclick="closeUiPopup()">ë‹«ê¸°</button>
  `);
}

document.getElementById('profPanel').addEventListener('click', openBrokerModal);
document.getElementById('blackPanel').addEventListener('click', ()=>popup('ì—†ëŠ”ê²ƒì´ ì—†ëŠ” ë¶ˆë²• ìƒì '));
document.getElementById('connPanel').addEventListener('click', ()=>popup('ë‹¹ì‹ ì˜ ê³ ë¯¼ì„ í•´ê²°í•´ë“œë¦½ë‹ˆë‹¤'));
document.getElementById('secretPanel').addEventListener('click', ()=>{
  if(state.logged[SECRET_OWNER]) popup('ë¹„ë°€ ì±„ë„ ì ‘ê·¼ í—ˆê°€ë¨.');
  else popup('ì ‘ê·¼ ë¶ˆê°€ â€” raven ì „ìš© ì±„ë„ì…ë‹ˆë‹¤.');
});

document.getElementById('pulseScan').addEventListener('click', ()=>{
  popup('í„ìŠ¤ ìŠ¤ìº” ì‹œì‘â€¦\nì£¼ë³€ ì‹ í˜¸ ë…¸ì´ì¦ˆ ë¶„ì„ ì¤‘â€¦');
  const g = document.getElementById('glitchRange');
  g.value = 6;
  applyGlitchStrength(6);
});

document.getElementById('darkTrace').addEventListener('click', ()=>{
  popup('ë‹¤í¬ íŠ¸ë ˆì´ìŠ¤ ëª¨ë“œ í™œì„±í™”.\nìµëª… ì±„ë„ ë£¨íŠ¸ë¥¼ ì¶”ì í•©ë‹ˆë‹¤.');
  const g = document.getElementById('glitchRange');
  g.value = 1;
  applyGlitchStrength(1);
});

function uiPopup(msg){
  const box = document.querySelector('#uiPopup');
  const content = document.querySelector('#uiPopupContent');
  content.innerHTML = msg;
  box.style.display = 'flex';
}

function closeUiPopup(){
  document.querySelector('#uiPopup').style.display = 'none';
}

  </script>

  <div id="sideNoiseLeft" class="sideColumn glitch"></div>
  <div id="sideNoiseRight" class="sideColumn glitch"></div>

  <!-- UI Popup -->
  <div id="uiPopup" class="popup" style="display:none;position:fixed;left:0;top:0;right:0;bottom:0;align-items:center;justify-content:center;z-index:999;">
    <div class="popup-content" id="uiPopupContent" style="background:rgba(0,0,0,0.85);border:1px solid var(--neon-cyan);padding:20px;border-radius:12px;max-width:380px;">
    </div>
  </div>
  
  <!-- Job Detail Popup -->
  <div id="jobModal" class="popup" style="
    position: fixed;
    left: 50%; top: 50%;
    transform: translate(-50%, -50%);
    width: 420px;
    padding: 24px;
    background: rgba(0,0,0,0.85);
    border: 1px solid var(--neon-pink);
    border-radius: 12px;
    box-shadow: 0 0 22px rgba(255,0,160,0.5), 0 0 10px rgba(0,255,255,0.4);
    display: none;
    z-index: 999;
    backdrop-filter: blur(6px);
  ">
    <div id="jobModalContent"></div>
    <button onclick="closeJobModal()" class="btn secondary micro" style="margin-top:14px;width:100%">ë‹«ê¸°</button>
  </div>

  <!-- Broker Profile Popup -->
<div id="brokerModal" class="popup" style="
position: fixed;
left: 50%; top: 50%;
transform: translate(-50%, -50%);
width: 420px;
max-width: 90vw;
padding: 24px;
background: rgba(0,0,0,0.9);
border: 1px solid var(--neon-cyan);
border-radius: 12px;
box-shadow: 0 0 22px rgba(0,255,255,0.5), 0 0 10px rgba(255,0,160,0.4);
display: none;
z-index: 999;
backdrop-filter: blur(6px);
">
<h2 class="glitch" data-text="Broker Profile">Broker Profile</h2>

<div id="brokerProfileBody" style="margin-top:10px;font-size:13px;color:var(--muted)">
  <!-- ğŸ”§ ì—¬ê¸°ëŠ” ë„¤ê°€ ë§ˆìŒëŒ€ë¡œ ìˆ˜ì •í•˜ë©´ ë˜ëŠ” ë¶€ë¶„ì´ì•¼ -->
  <div><strong>ì½”ë“œ ë„¤ì„</strong>: <span id="brokerName">celernea</span></div>
  <div><strong>ì†Œì†</strong>: <span>NeoRivere Â· Obsidian Directive ë¸Œë¡œì»¤</span></div>
  <div style="margin-top:8px"><strong>ì „ë¬¸ ë¶„ì•¼</strong></div>
  <ul style="margin-top:4px;padding-left:18px">
    <li>ì „ëµ ì„¤ê³„ì™€ ì¥ê¸° ì‹œë®¬ë ˆì´ì…˜</li>
    <li>ì˜ë„ì™€ íŒ¨í„´ì„ ë½‘ì•„ë‚´ëŠ” ì •ë³´ ë¸”ë Œë”©</li>
    <li>ê±°ë˜ì™€ ì‹¬ë¦¬ì „ì„ ë™ì‹œì— ì„¤ê³„í•˜ëŠ” ë¸Œë¡œì»¤ë§</li>
  </ul>

  <div style="margin-top:8px"><strong>íŠ¹ì´ ì‚¬í•­</strong></div>
  <p style="margin-top:4px">
    ì‹ ì²´ ê°œì¡°ê°€ ì „í˜€ ì—†ëŠ” 'ìˆœìˆ˜ ì¸ê°„'ì„ì—ë„, ì •ë³´ì™€ ê³„ì‚°ë§Œìœ¼ë¡œ ë„¤ì˜¤ë¦¬ë² ë¥´ ìµœìƒìœ„ ê¶Œë ¥ì„ ìœ ì§€í•œë‹¤.
    ì›ƒì„ìˆ˜ë¡ ê²°ì •ì€ ë” ì°¨ê°‘ê²Œ ë‚´ë ¤ì ¸, ì£¼ë³€ ì¸ë¬¼ë“¤ì—ê²Œ í•­ìƒ ë¬˜í•œ ê¸´ì¥ê°ì„ ì¤€ë‹¤.
  </p>
</div>

<button onclick="closeBrokerModal()" class="btn secondary micro" style="margin-top:14px;width:100%">
  ë‹«ê¸°
</button>
</div>

<!-- ROUTING Overlay -->
<div id="routeOverlay">
  <div id="routeOverlayInner">
    <div id="routeOverlayTitle">NEORIVERE Â· ROUTING</div>
    <div id="routeOverlayText" class="glitch" data-text="ROUTING...">
      ROUTING...
    </div>
  </div>
</div>


</body>
</html>
